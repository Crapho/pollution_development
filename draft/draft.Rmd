---
title: "Air pollution and agricultural productivity in a developing country^[I thank Ariel Ortiz-Bobea, Marc Bellemare, and David Sungho Park for comments and suggestions that greatly improved the quality of the paper, as well as conference attendees at the 2023 KER International Conference. The usual disclaimer applies. All scripts used in this paper are publicly available on my GitHub page: github.com/JoshMerfeld/pollution_development]"
author:
  - Joshua D. Merfeld^[KDI School of Public Policy and Management and IZA; merfeld@kdis.ac.kr]
date: "`r Sys.Date()`"
abstract: |
  | \noindent I document negative externalities of air pollution in the Indian agricultural sector. Using variation in pollution induced by changes in wind across years, I show that higher levels of pollution lead to decreased agricultural productivity, with large changes in productivity being common. The negative effects of pollution are larger in areas growing more labor-intensive crops, indicating that the pollution works at least partly through direct effects on labor productivity. Finally, combining wind direction with the rollout of coal plants, results indicate that pollution from coal plants has a larger effect on agricultural productivity than other types of pollution. Given that the agricultural sector is a refuge for the poor in many developing countries, these results suggest that the negative externalities of pollution may hit the poorest particularly hard.
  |
  | \textbf{\textit{Keywords}}: pollution, productivity, agriculture, labor, India
  | \textbf{\textit{JEL Codes}}: H40, I15, J22, O13, Q52, Q53

# Output type and options (no TOC and yes fig captions)
output:
  bookdown::pdf_document2: 
    toc: false
    fig_caption: yes
    # This also keeps the .tex file that is used to make the output (we will eventually need this for publication)
    keep_tex: yes

# Set bibliography
bibliography: references.bib

# This includes latex arguments
header-includes:
  - \newcommand{\beginappendix}{   
      \setcounter{table}{0}
      \renewcommand{\thetable}{A\arabic{table}} 
      \setcounter{figure}{0} 
      \renewcommand{\thefigure}{A\arabic{figure}}
    }  # Relabel appendix tables/figures as e.g. A1
  - \usepackage[capposition=top]{floatrow}
  - \usepackage{placeins}   # THis is for /FloatBarrier
  - \usepackage{setspace}
  - \usepackage{dcolumn}
  - \usepackage{booktabs}
  - \usepackage{siunitx}
  - \usepackage{amsmath}
  - \usepackage{enumerate}
  - \usepackage[shortlabels]{enumitem}
  - \usepackage[hang,flushmargin]{footmisc}		# no indents on footnotes
  - \usepackage{makecell}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, dev = "png") # NOTE: switched to png instead of pdf to decrease size of the resulting pdf

library(sf)
library(sp)
library(tidyverse)
library(scales)
library(RColorBrewer)
library(kableExtra)
library(ggpubr)
library(ggthemes)
library(rticles)
library(stats)
library(broom)
library(extrafont)
library(fixest)
library(modelsummary)
library(openxlsx)
library(raster)
library(viridis)
library(stars)
loadfonts()  # Must be run once in each session (markdown is a new "session" each time you render/knit)



# We want to get the wd up to the main folder
# Need to go up two levels
setwd('..')
setwd('..')
# Double check
getwd()    # check


reportP <- function(pValue){
  if (pValue < 0.001){
    result <- "p < 0.001"
  } else {
    result <- sprintf("p = %.3f", pValue) # inserts a float into a string and simultaneously do rounding
  }
  return(result)
}

reportDec <- function(dec){
  
    result <- sprintf("%.3f", dec) # inserts a float into a string and simultaneously do rounding
  
  return(result)
}

reportDecOne <- function(dec){
  
    result <- sprintf("%.1f", dec) # inserts a float into a string and simultaneously do rounding
  
  return(result)
}

reportPercent <- function(dec){
  
    result <- sprintf("%.1f", 100*dec) # inserts a float into a string and simultaneously do rounding
  
  return(result)
}

commaNum <- function(large){
  
  
  result <- formatC(large, big.mark = ",")

  return(result)
}


# Shapefile of india
india_shape <- read_sf("data/spatial/shapefiles/state.shp")



# Coal plants
### Load raw data ----------------------------------------------------------------------------------------------------------------------------------------------------------
plants <- read.xlsx("data/raw/coal_plants.xlsx", sheet = "Units")
# India only
plants <- plants %>% filter(Country=="India")
# Also want only things with a non-missing year
plants <- plants %>% filter(is.na(Year)==F)

# Just keep what we want 
plants <- plants %>% dplyr::select(plant_id = ParentID, 
                                   unit_id = Tracker.ID, 
                                   capacity = `Capacity.(MW)`, 
                                   year_built = Year, 
                                   year_retired = RETIRED, 
                                   lat = Latitude, 
                                   lon = Longitude)


gps_points_plants <- plants %>% dplyr::select(lon, lat)
plants <- st_as_sf(SpatialPointsDataFrame(gps_points_plants, plants %>% dplyr::select(-c(lon, lat)), proj4string = CRS("EPSG:4326")))
plants <- plants %>% mutate(capacity = capacity/1000)

plants1990 <- plants %>% 
                  filter(year_built<=1990 & (year_retired>1990 | is.na(year_retired)==T)) %>%
                  group_by(plant_id) %>%
                  mutate(capacity = sum(capacity)) %>%
                  filter(row_number()==1) %>%
                  ungroup()
                  
plants2010 <- plants %>% 
                  filter(year_built<=2010 & (year_retired>2010 | is.na(year_retired)==T)) %>%
                  group_by(plant_id) %>%
                  mutate(capacity = sum(capacity)) %>%
                  filter(row_number()==1) %>%
                  ungroup()


# wind example
windexample <- readRDS("data/spatial/windexample.rds")


# district
districts <- read_sf(paste0("data/spatial/districts/districts.shp"))
districts <- districts %>% 
                dplyr::select(state = ST_CEN_CD, district = DT_CEN_CD, state_name = ST_NM, district_name = DISTRICT)
districts <- districts %>% filter(state=="23" & district=="07")
# Villages
villages <- read_sf(paste0("data/spatial/villages_overlap/villages_overlap.shp"))
villages <- villages %>% mutate(shrid = paste0(pc11_s_id, "-", pc11_tv_id)) %>%
                          dplyr::select(shrid, state = ST_CEN_CD, district = DT_CEN_CD, state_name = ST_NM, district_name = DISTRICT)
village_shp <- villages
villages <- villages %>% filter(state=="23" & district=="07")
wind <- read_csv(paste0("data/clean/wind_ntl/days/date_2010-1-1.csv")) %>% as_tibble()
wind$days_sum <- apply(wind[,2:8], 1, FUN = "sum")
wind <- wind %>% dplyr::select(shrid, days_sum)
villages <- villages %>% left_join(wind, by = "shrid")
villages <- villages %>% st_set_crs(st_crs(districts))
village_shp <- village_shp %>% st_set_crs(st_crs(districts))
# and crs for plants
plants1990 <- plants1990 %>% st_transform(st_crs(districts))
plants2010 <- plants2010 %>% st_transform(st_crs(districts))
india_shape2 <- india_shape %>% st_transform(st_crs(districts))

villages <- st_snap(villages, districts, tolerance = 1250)
crops_all <- read_csv(paste0("data/clean/ag_productivity/crop_area.csv"))


# Tables
plantresultstable <- readRDS("pollution_development/draft/tables/plantresultstable.rds")
pollutiontable <- readRDS("pollution_development/draft/tables/pollutiontable.rds")
yield1reducedform <- readRDS("pollution_development/draft/tables/yield1reducedform.rds")
yield2naive <- readRDS("pollution_development/draft/tables/yield2naive.rds")
yield3ivmainfirststage <- readRDS("pollution_development/draft/tables/yield3ivmain_firststage.rds")
yield3ivmain <- readRDS("pollution_development/draft/tables/yield3ivmain.rds")
yield3ivmain_lead <- readRDS("pollution_development/draft/tables/yield3ivmain_lead.rds")
yield4monthly <- readRDS("pollution_development/draft/tables/yield4monthly.rds")
yield5heterogeneity <- readRDS("pollution_development/draft/tables/yield5heterogeneity.rds")
yield6leads <- readRDS("pollution_development/draft/tables/yield6leads.rds")
yield7ivdiffindiff <- readRDS("pollution_development/draft/tables/yield7ivdiffindiff.rds")
yield8cumulative <- readRDS("pollution_development/draft/tables/yield8cumulative.rds")
labor1all <- readRDS("pollution_development/draft/tables/labor1all.rds")
labor2rural <- readRDS("pollution_development/draft/tables/labor2rural.rds")
labor3month <- readRDS("pollution_development/draft/tables/labor3month.rds")
laborplot <- readRDS("pollution_development/draft/tables/laborplot.rds")
monthplot <- readRDS("pollution_development/draft/tables/monthplot.rds")
opplot <- readRDS("pollution_development/draft/tables/opplot.rds")
coef_vec <- readRDS("pollution_development/draft/tables/randomization_coef_vec.rds")
coefs_distfe <- readRDS("pollution_development/draft/tables/randomization_coefs_distfe.rds")
true_value <- readRDS("pollution_development/draft/tables/randomization_true_value.rds")
coef_current <- readRDS("pollution_development/draft/tables/coef_current.rds")
coef_lead <- readRDS("pollution_development/draft/tables/coef_lead.rds")
yieldrice <- readRDS("pollution_development/draft/tables/yieldrice.rds")
yieldricestatefe <- readRDS("pollution_development/draft/tables/yieldricestatefe.rds")


plants1990_capacity <- plants %>% filter(year_built<=1990 & (year_retired>1990 | is.na(year_retired)==TRUE))
plants2010_capacity <- plants %>% filter(year_built<=2010 & (year_retired>2010 | is.na(year_retired)==TRUE))

```

```{r, echo = F}
# This chunk will allow us to add footers below figures
library(ggplot2)

hook_plot_tex_footer <- function(x, options) {  
  x_out <- knitr:::hook_plot_tex(x, options) 
  if(!is.null(options$fig.footer)) {
    inter <- sprintf("\\floatfoot*{%s}\n\\end{figure}", options$fig.footer[1])
    x_out <- gsub(x=x_out, pattern="\n\\end{figure}", replacement=inter, fixed=TRUE)
  }
  x_out
}

knitr::knit_hooks$set(plot=hook_plot_tex_footer)

```

```{=tex}
\newpage
\doublespacing
```
# Introduction

While reliance on coal is declining in much of the world, it continues to be an important source of energy in many countries. In 2021, energy generation from coal reached an all-time high,[^1] driven in part by rapid population growth in developing countries, including India. From 1990 to 2010, India's population grew by more than 40 percent, leading to a large increase in demand for power.[^2] While natural gas has become a popular alternative in much of the world, the Indian government met much of the increased demand through the construction of coal power plants. During those same two decades, power generation from all coal units of at least 30 megawatts in the country more than doubled, from 42.4 gigawatts to more than 100 gigawatts.[^3]

[^1]: www.iea.org/reports/coal-fired-electricity

[^2]: data.worldbank.org

[^3]: globalenergymonitor.org/

While there may be positive effects from this increase in power generation -- for example, electricity may lead to economic and productivity growth [@dinkelman2011effects; @kline2014local; @rud2012electricity; @van2017long], though electrification alone may not be a sufficient condition [@lee2020does] -- these improvements do not come without downsides, especially when it comes to power derived from coal. Pollutants from coal contribute to climate change and the phase out of coal energy is, therefore, a major climate goal [@iea2022]. Emissions from the production and burning of coal are also directly harmful to human health and the environment; pollutants like sulfur dioxide, nitrogen oxides, methane, and mercury are particularly harmful.[^4] While the use of coal had been declining, recent events -- including Russia's invasion of Ukraine -- have led to an increase in the demand for coal.[^5]

[^4]: www.eia.gov/energyexplained/coal/coal-and-the-environment.php

[^5]: www.npr.org/2022/08/15/1117560560/a-rising-demand-for-coal-amidst-war-in-ukraine

In addition to pollution from coal, pollution more generally is also increasing in much of the world. Carbon dioxide equivalent per capita has almost double over the last 50 years in India, more than doubled in Indonesia, and almost tripled in China.^[https://edgar.jrc.ec.europa.eu] Much of this increase is due to the development process itself -- as countries develop, their economies transform, with more people moving out of agriculture and into manufacturing and services [@herrendorf2014growth]. Despite this development, agriculture remains a key sector in many developing countries, employing a large proportion of the poor [@dercon2009rural]. This also means agriculture is a key sector when it comes to poverty reduction [@christiaensen2011evolving]. Given the large effects of pollution on health and previously documented impacts on agriculture, this raises a important question: do rising pollution levels in developing countries threaten agricultural productivity?

In this paper, I study the effects of pollution on agricultural productivity in India. Previous work has suggested that there may be harmful direct effects of air pollution [@heck1982assessment; @marshall1997hidden] and water pollution [@reddy2006impact] on agricultural productivity, including work showing that gold mines -- which release large amounts of pollutants into the surrounding environment -- lead to lower agricultural productivity in Ghana [@aragon2016polluting]. These effects can work through the well-known effects on human health and productivity, but also directly through land productivity. Black carbon in soot, for example, can directly affect solar radiation reaching plants on the surface [@ramanathan2008global; @burney2014recent], while, on the other hand, sulfur in some pollution sources can actually be productivity enhancing [@sanders2022adaptation]. Relative to previous work in economics, this paper tackles pollution more broadly, before turning to a specific source of pollution: coal plants. I show that air pollution leads to lower agricultural productivity in India and that pollution from coal plants is particularly harmful to agriculture.

Identifying the causal effects of pollution is difficult. For starters, the construction of coal plants is likely to be endogenous, though the relationship between construction and economic conditions is not a priori clear. On the one hand, governments may locate new plants in fast-growing areas, while on the other hand, they may decide the exact location of plants based on the political power of local citizens [@kopas2020environmental]. In the case of the data I use here, coal plants are constructed in areas with higher population and higher levels of pollution. In terms of agriculture, higher productivity predicts more coal plants in a given year as well as the construction of a coal plant over the next decade, indicating possible bias when estimating effects of pollution on agricultural productivity.

To identify the effects of air pollution on agricultural productivity, I identify areas of high pollution emission using the location of coal plants. While coal plants may add emissions, I show that they are located in areas with relatively higher levels of pollution, in general. Using these locations as point sources of pollution, I use plausibly exogenous changes in wind direction -- in a similar spirit to @deryugina2019mortality -- to measure the effects of pollution on key agricultural outcomes. I first plot the location of coal plants in India by year. Using a village-level shapefile, I identify all villages that are located within 30km of a coal plant at any time during the sample period, which comprises the 2000s to the 2010s, with differences across outcomes depending on data availability. I then calculate the direction from each coal plant to all villages within 30km. I include all areas, regardless of whether the coal plant has opened yet, to allow me to disaggregate the effects of pollution from coal plants with other kinds of pollution later in the paper. 

Using daily wind data and these spatial variables, I create an identifier separately for every village for whether a given village is located downwind from a coal plant on any given day. I then aggregate this exposure variable based on the desired analysis; for agricultural productivity, for example, I create an exposure variable measuring the total number of exposure days in the five-month agricultural season, focusing only on the monsoon (Kharif) season. More days being located downwind from a high-pollution location leads to substantially higher average concentrations of particulate matter 2.5 (PM 2.5).^[PM 2.5 is defined as particulate matter with a diameter of less than 2.5 micrometers.]

Using wind direction as an instrument for particulate matter, an increase of PM 2.5 by one percent leads to a large decrease in agricultural productivity, with an elasticity of approximately -0.63 in the most conservative specification. The IV estimates indicate that the effect of pollution is more negative than naïve OLS estimates, which is consistent with the evidence on the construction of coal plants; higher levels of pollution are correlated with higher levels of agricultural productivity, a relationship that the IV strategy adjusts downwards. Robustness checks confirm these main results. Randomization inference shows that the estimates are robust to alternative measures of uncertainty, while leads of pollution do not affect current agricultural productivity.

Heterogeneity analysis shows that the negative effects of pollution are larger in villages that experience higher median exposure to pollution and in villages with higher initial yields. Finally, given how many poor farmers rely on rainfall and how weather shocks are on the rise across the globe, I also look at possible multiplicative effects of shocks by interacting the pollution variables with a rainfall variable. Higher exposure along with less rainfall increases the negative effect of either shock individually, meaning these shocks are compounding. Given concerns regarding agricultural productivity and climate change, the rise of pollution in India may be particularly problematic for poor farmers.

A key question is the mechanism: does pollution reduce labor productivity, land productivity, or both? While previous work from the United States indicates that pollution from coal plants, specifically, can lead to higher _land_ productivity [@sanders2022adaptation], agriculture in India differs greatly from agriculture in the United States. To test for possible effects on labor productivity, I look at differential effects based on labor intensity of the predominant crops in different villages. Specifically, I separate effects in predominantly rice-growing areas from other areas; since rice is very labor intensive, we would expect to see larger negative effects of pollution in rice-growing regions relative to other regions if one mechanism through which pollution affects productivity is direct effects on labor. I show that pollution negatively effects agricultural productivity in non-rice areas but that the effects in rice-growing areas are around 50 percent larger in magnitude. These results indicate that pollution likely directly affects labor productivity, though I am not able to rule out direct effects on land, either, due to a lack of data.

The final set of analyses tries to disentangle the effects of pollution from the effects of coal pollution, specifically, by using wind direction and the rollout of coal plants across the country. Combining instrumental variables with a differences-in-differences strategy, I show that agricultural productivity has an elasticity of around -0.22 with respect to non-coal pollution. The opening of a coal plant, however, doubles the elasticity, to more than -0.44, indicating that coal plant emissions are particularly harmful to agricultural productivity, at least in India. This is consistent with coal emissions being quite different from other forms of pollution; coal emissions contain different types and quantities of harmful substances, meaning effects may differ greatly.

An important caveat to these results is that I cannot disentangle exactly which pollutants drive results. While I use PM 2.5 as a measure of overall exposure to pollution, effects could be driven by any pollutants carried by the wind. This leaves open an important avenue of future research regarding the effects of different types of pollutants on agricultural productivity.

This paper contributes to several strands of literature. We already have evidence of effects of pollution on different forms of labor activity. For example, general levels of pollution decrease productivity of call center works in China [@chang2019effect], lead people to perform worse on cognitive functions [@ebenstein2016long; @wen2022lower], and also lead to lower levels of farm labor productivity in California, driven by changes in ozone concentration [@graff2012impact]. Also in China, @he2019severe find small but significant negative effects of pollution on manufacturing productivity, while @chen2022effect show pollution leads to labor out migration. Relevant to my results, @hanna2015effect show that decreases in pollution lead to increases in labor allocation in another developing country. 

Several papers are closely related to this one. @aragon2016polluting show that gold mines in Ghana have substantial negative impacts on agricultural productivity in the surrounding areas. @burney2014recent model the effects of climate change and pollutants on agricultural productivity in India. Finally, @sanders2022adaptation actually find that coal emissions can be good for agriculture in the United States, due to the presence of sulfur, which can increase agricultural productivity. This paper differs from the previous literature in three important ways. First, I explore effects of pollution more generally as well as from coal plants, which are much more ubiquitous than gold mines across the world. Second, I use a different identification strategy from most other papers, relying on wind blowing pollution from coal plants. Finally, agriculture in India and the United States can be quite different, with the latter being much more mechanized. This means effects of pollution could differ substantially depending on the context, a conclusion that the current results support. 



# Data

\label{data}

The main goal of this paper is to examine whether exposure to pollution affects agricultural productivity, as well as to provide evidence about the effects of pollution from coal plants, in particular. I use several sources of data, which I describe here and list in Table \@ref(tab:data) of the appendix.

The first set of data lists the location of coal plant across the globe. This data comes from Global Energy Monitor[^6] and lists all units generating at least 30 megawatts of electricity. The data on coal plants includes the year of opening (and, if applicable, the year of retirement), the GPS (latitude/longitude) location of each plant, and the amount of power produced by the units at each plant. For this paper, I do not use the information on the capacity of the plant.

[^6]: globalenergymonitor.org/projects/global-coal-plant-tracker/

Figure \@ref(fig:plants) in the appendix displays the location of coal plants in India for two specific years: 1990 and 2010. There is a clear increase in the prevalence of coal plants across the country over the two decades. Additionally, the overall capacity from coal plants increased from `r paste0(reportDecOne(sum(plants1990_capacity$capacity)))` gigawatts to `r paste0(reportDecOne(sum(plants2010_capacity$capacity)))` gigawatts, an increase of `r paste0(reportPercent((sum(plants2010_capacity$capacity) - sum(plants1990_capacity$capacity))/sum(plants1990_capacity$capacity)))` percent in just 20 years. This increase is driven both by the roll out of new plants as well as the construction of new units at existing plants, the latter of which is not shown in Figure \@ref(fig:plants).

The second dataset includes agricultural productivity for both the monsoon and winter seasons, from 2002 to 2018. To match other data, I only use the data up to 2013. This data comes from @gangopadhyay2022new and estimates land productivity (i.e. yield, in tons per hectare) for the major crops in India, using satellite-derived data. While there is a wealth of literature on measurement error in land [@desiere2018land; @abay2022nonclassical], the authors use a static cropland mask for the productivity estimates. This means that any measurement error will hopefully be constant across time and subsumed by the village fixed effects. While the measure of output is also noisy, the use of satellite-derived data and a static cropland mask reduces concerns about measurement error being responsible for the results below, especially since common sources of measurement error are unlikely to be correlated with wind direction. The authors define the monsoon season as June to October and the winter season as November to March. Due to large differences in the crops grown and the production technologies used across seasons, I focus on only the monsoon season and keep the authors' definition when matching across data below. The data on agricultural productivity is publicly available from Nature's data-sharing website.[^7] Since the main regressions below use village fixed effects, any differences in cropping patterns across areas should not bias estimates on changes, as long as these patterns do not change markedly in response to annual pollution levels.

[^7]: springernature.figshare.com

The agricultural productivity data is available as raster files with a resolution of 500m. To aggregate this data up to a useful administrative unit, I use village-level shapefiles provided by @almn2021 and publicly available on the SHRUG platform.[^8] I aggregate the agricultural productivity data to the village level by extracting mean productivity for each feature in the shapefile. I do this separately for the monsoon season each year, from 2002 to 2013.

[^8]: www.devdatalab.org/shrug_download/

To measure exposure to pollution from point sources around coal plants, I first locate all village centroids located within 30km from a coal plant in a given year. I choose 30km due to previous research on the effects of (air) pollution [@aragon2016polluting; @bencko1977health; @li2014health]. I then calculate the direction from these point sources to all village centroids within that 30km radius. To define exposure, I pull daily wind direction data from the National Center for Atmospheric Research.[^9] For each day, I document whether the wind is blowing towards each village centroid[^10] and then temporally aggregate this daily data depending on the temporal definition of the corresponding outcome. For example, agricultural productivity is defined across five months (i.e. the monsoon season is from June to October) so I count the total days a given village is exposed to wind blowing from *any* coal plant within 30km during those five months.

[^9]: climatedataguide.ucar.edu/

[^10]: I define "towards" as within five degrees to help take into account that I am using village centroids. The wind data includes both the x and y components of wind speed, which I can use to calculate angles from point sources to village centroids.

The top panel in Figure \@ref(fig:windexample) in the appendix is an example wind direction raster. The raster shows wind direction for the entirety of India on January 1st, 2010, as well as the location of coal power plants on that date. The prevailing winds on the date differ across the country and, though not shown in the figure, across days. This means that the overall exposure for a given area to coal plant emissions changes across time. 

For pollution data, I use estimated particulate matter (PM). Specifically, I use estimates of PM 2.5, which includes particles with a diameter of 2.5 micrometers or less. This data comes from @hammer2020global and is available as a raster with a resolution of 0.01 degrees. I aggregate this data to the village level by extracting the mean PM for each feature in the shapefile. I do this separately for each month from June 2002 to October 2013. The bottom panel in Figure \@ref(fig:windexample) in the appendix is an example of the PM data. The figure shows the estimated PM 2.5 from for each village in Guna district of Madhya Pradesh on January 1st, 2010.

While I use PM 2.5 as the estimated level of pollution, it is important to clarify that I cannot explicitly say that PM 2.5, per se, is responsible for any effects. Pollution includes a variety of different components, including PM 2.5, PM 10, sulfur dioxide, and nitrogen dioxide, to name but a few. While I use PM 2.5 as a proxy for pollution, it is possible that other components are responsible for the effects. Additionally, the PM 2.5 data is estimated using satellite data and a machine learning algorithm. While this is a common approach in the literature ( see @hammer2020global for more details), it is important to note that the estimates are not direct measurements of pollution. However, a valid instrumental variable can help for any measurement error present in the data [@glewwe2012much; @gillen2019experimenting].

To help understand some of the mechanisms driving the relationship between exposure to emissions and agricultural productivity, I also look at the differential effects by the labor intensity of the predominant crop in each area. For this, I use data from @monfreda2008farming, who estimate area harvested for different crops across the global around the year 2000. I identify areas where rice (paddy) is the most commonly grown crop, under the assumption that rice is more labor intensive than other crops [@vollrath2011agricultural; @michler2020agriculture].  @michler2020agriculture, for example, shows that rice, on avearge, uses almost 1,800 hours per hectare, while the second-highest crop in his data, cotton, juses just 850. He also estimates that wheat, another common crop in India, uses just 600 hours per hectare.




# Methods

\label{identification} 


I am primarily interested in the effects of pollution on agricultural productivity. We might consider a regression of the following form:
\begin{gather} y_{it} = \alpha_{i} + \gamma_{t} + \beta PM_{it} + \delta rain_{it} + \psi temp_{it} + \varepsilon_{it}, \end{gather}

where $y_{it}$ is outcome $y$ for unit $i$ at time $t$, $\alpha$ is a geographic fixed effects, $\gamma_t$ is time fixed effects, $PM_{it}$ is the (log) concentration of particulate matter 2.5, $rain_{it}$ is total rainfall during the season, and $temp_{it}$ is average temperature during the season.

However, even with the fixed effects, this regression likely suffers from endogeneity; places with more pollution may be very different from places with less pollution. It is difficult to sign the direction of the bias a priori, because it depends on the local context and how the coal plants are placed. For example, if coal plants are placed in places in need of power -- for example, due to rapid growth -- then the estimates might be upwards biased. On the other hand, if officials purposefully place coal plants in poorer areas for political reasons, then the estimates might be downwards biased. 

What are the characteristics of areas near the construction of new coal plants? Table \@ref(tab:plantresultstable) presents four separate regressions, using state-level fixed effects due to the spatial variation in coal plants. The first two columns use 1991 census data -- downloaded from SHRUG -- and the second two columns use 2001 census data, all at the village level. The first column presents results from regressing a dummy for whether there is a coal plant within 30km in 1991 on several census variables. Villages with higher population densities (higher log population and lower log area) are more likely to be near a coal plant at the time. Urban population proportion is not a significant predictor after conditioning on population and area.

```{r plantresultstable, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(plantresultstable) <- c("1991", "2001", "2001", "2011")
rownames(plantresultstable) <- c("Population (log)", "", "Area (log)", "", "Urban pop (prop)", "", "Ag. productivity", "", "Pollution (log PM 2.5)", "",
                                "Sub-sample", "Observations")
kable(
      plantresultstable, caption = "Local characteristics and the construction of coal plants",
      align = "cccc", booktabs = TRUE, linesep = "", escape = FALSE
      ) %>%
  footnote(
           "Note: State fixed effects are included in regressions. Robust standard errors are in parentheses. The outcome in the first column is whether the village is within 30km of a coal plant in 1991. The second column is whether a village in 1991 will have a coal plant in 2001, conditional on not having one in 1991. The last two columns are similarly defined, except using 2001 and 2011 as the years. * p<0.10 ** p<0.05 *** p<0.01",
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE,
           escape = FALSE
           ) %>%
  column_spec(1, width = "3.5cm") %>%
  column_spec(c(2:5),width = "2cm") %>%
  row_spec(11, hline_after = TRUE) %>%
  add_header_above(c(" ", "1991 census" = 2, "2001 census" = 2)) %>%
  kable_classic_2()

```

The second column keeps the 1991 census data but changes the outcome variable to a dummy for whether there *will be* a coal plant constructed within 30km before 2001. This column restricts the sample to only villages that do not already have a coal plant within 30km in 1991. The pattern of significance remains the same in column two.

The last two columns are particularly relevant to the current results. They present similar results to those in the first two columns, but use the 2001 census data and a dummy for the presence of a coal plant in 2001 and 2011 in columns three and four, respectively. Importantly, I include agricultural productivity in the monsoon season of 2002 -- the earliest year available -- as well as average pollution during the monsoon season for 1998 through 2000 as additional predictors. In 2001, agricultural productivity is a strong predictor for the presence of a coal plant. Moreover, it is also a significant predictor of the construction of a coal plant between 2001 and 2011 (column four). Given that the coefficient is positive, this indicates that coal plants are more likely to be built in areas with higher agricultural productivity. In other words, any selection in the overall location of coal plants would bias against finding negative effects of pollution on agricultural productivity. However, note that this is not the same as looking at wind direction, though comparing the OLS and IV results below leads to the same conclusion regarding selection. 

Pollution is also a significant predictor for the presence of a coal plant in 2001 as well as for whether a coal plant will be constructed before 2011. While the coefficient is relatively small, it is actually quite large given that only three percent of villages in column four will get a new plant in the next decade.

Since pollution is likely to be endogenous, a naïve OLS regression will not return unbiased estimates. The experimental ideal would be to randomly assign pollution to villages, but this is obviously not possible. Instead, I use an instrumental variables (IV) approach to identify the causal effects of pollution on agricultural productivity. The key identifying assumption is that wind direction is exogenous from year to year, conditional on village fixed effects and weather. While the location of pollution sources might be endogenous, the amount of pollution received by a specific village in a given year can vary randomly based on wind direction. By counting the number of days in a given year that a village is downwind from a polluted area and conditioning on village fixed effects and weather (rainfall and temperature), variation across years is plausibly exogenous. Since I include village fixed effects, identification comes from within-village changes in wind direction across years.

Consider the reduced form effect of wind exposure on agricultural productivity:
\begin{gather} PM2.5_{it} = \alpha_{i} + \gamma_{t} + \beta wind_{it} + \delta rain_{it} + \psi temp_{it} + \varepsilon_{it}, \end{gather}

where variables are defined identically to above but with wind as the primary variable of interest instead of pollution. Combining these into a two-stage procedure, we can instrument for pollution using wind direction; small changes in wind direction can lead to large changes in pollution exposure for villages located near point sources of pollution, allowing me to identify the causal effects of pollution by isolating the random component driven by wind direction. This is similar in spirit to @deryugina2019mortality.

Identification relies on changes in wind direction across time for the same geographic units. In other words, conditional on the fixed effects and weather, I assume changes in wind direction are as good as random and uncorrelated with the outcome -- primarily agricultural productivity in this paper -- except through exposure to pollution.

The inclusion of rainfall and temperature is meant to reduce concerns that wind direction may not affect agricultural productivity but, instead, be correlated with it through changes in weather. For example, prevailing winds from one direction may be associated with dry weather, while winds from another direction may be more likely to carry moisture and rain. It is not a priori clear how this would bias the estimates with respect to pollution and coal plants, however. The differences in weather patterns is very context specific and can differ even for villages located near one another.

I believe there are two reasons this is unlikely to be the case here. First, villages located near one another have very similar weather patterns, but wind direction leads to large differences in pollution exposure even for villages right next to one another. Second, in some specifications, I include very flexible specifications for weather. These inclusions do not lead to very large changes in the estimated relationship between pollution and agricultural productivity, suggesting that weather is unlikely to be responsible for a spurious correlation between productivity and pollution in the main results.

It is worth taking the time to validate the use of wind direction as a measure of exposure to pollution. Consider the data used for the regressions presented in Table \@ref(tab:yield3ivmainfirststage) of the appendix. The outcome variable is particulate matter -- specifically, $\mathrm{PM 2.5}$, which is particulate matter no larger than 2.5 micrometers in diameter -- which comes from @hammer2020global. $\mathrm{PM 2.5}$ is one of the harmful byproducts from many industrial processes, including power generation. Particulate matter is a major component of the pollution emitted by coal plants, along with sulfur dioxide, different types of nitrogen oxides, and mercury.[^12] This data is available at the monthly level, but I aggregate variables to the season variable since that is the level of analysis in the main results.

[^12]: www.epa.gov/airmarkets/power-plants-and-neighboring-communities

Both the particulate matter data and the wind data is at the village level, which means the regressions in Table \@ref(tab:yield3ivmainfirststage) are at the village level. As such, the geographic fixed effects are village fixed effects and the temporal fixed effects are month fixed effects. Since the exposure variable is at the village level and we follow villages over time, the standard errors are also clustered at the village level. I add more and more flexible specifications for weather, with the most flexible specification in the fourth column. Note that the relationship between wind direction and particulate matter is very similar across all four columns, suggesting that the inclusion of weather does not change the relationship between wind direction and pollution. This is important because it suggests that the use of wind direction as a proxy for pollution exposure is not biased by weather patterns.


## Identifying mechanisms

A key question is how pollution affects agricultural productivity. Specifically, does pollution directly affect labor productivity, land productivity, or both? Unfortunately, there is a lack of data that would allow me to directly test these mechanisms, since I do not have data on the amount of labor or land used in each village. Instead, I look at heterogeneity in the effects of pollution based on the predominant crop grown in each village. 

@michler2020agriculture presents estimates of labor intensity for several major crops in India. The most labor-intensive crop is rice, which uses almost 1,800 hours per hectare. The second-most labor-intensive crop is cotton, which uses just 850 hours per hectare. Wheat, another common crop in India, uses just 600 hours per hectare. This suggests that pollution should be more harmful for rice than for other crops if there are direct impacts on labor productivity.

To identify this possible mechanism, I identify areas that grow predominantly rice. Specifically, I estimate the following regression:
\begin{gather} 
y_{it} = \alpha_{i} + \gamma_{t} + \omega PM_{it} + \phi rice_{it} + \beta PM_{it}\times rice_{it} + \delta rain_{it} + \psi temp_{it} + \varepsilon_{it},
\end{gather}
where $PM_{it}$ denotes the effect of pollution in non-rice areas and $PM_{it}\times rice_{it}$ is the differential effect in rice-growing areas. Here, I create an indicator variable for rice areas that is time invariant, so $rice_{it}$ drops out of the estimation. I instrument for $PM_{it}$ and for $PM_{it}\times rice_{it}$ using wind and wind interacted with the indicator for rice.

While this is a useful first step, it is not a perfect identification strategy. First, there could be other differences in the types of areas that grow rice, and these differences could actually be responsible for any heterogeneity. Second, this strategy does not allow me to say anything about the effects of pollution on land productivity. 



## Identifying effects of pollution from coal plants

I use the location of coal plants to identify locations of high pollution emission, but there can be other pollution sources located near coal plants, as well. I nonetheless also want to identify the effects of pollution coming specifically from coal plants, in addition to the overall effects of pollution in the other parts of the paper. I do this by combining the two-stage procedure above with a differences-in-differences framework. Specifically, I create a new variable identifying the exact year the coal plant opens in a given area and calculate the change in the effects of pollution on agricultural productivity.

Consider the following regression of interest:
\begin{gather} 
y_{it} = \alpha_{i} + \gamma_{t} + \omega PM_{it} + \phi open_{it} + \beta PM_{it}\times open_{it} + \delta rain_{it} + \psi temp_{it} + \varepsilon_{it},
\end{gather}

where the interaction term $PM_{it}\times open_{it}$ indicates the change in the effect of pollution following the opening of the coal plant. Note that this is not the same as saying that pollution increased; instead, it is focusing on the change in the effect of a change in pollution of one unit on the outcome of interest, agricultural yield. I instrument for both $PM_{it}$ and $PM_{it}\times open_{it}$ using wind and the interaction between wind and the open indicator, or $wind_{it}\times open_{it}$.



# Results

\label{results}

I first present the reduced form results for agricultural productivity. The outcome for all regressions in this section is the log of agricultural land productivity, which is defined as tons per hectare. The first set of results are in Table \@ref(tab:yieldtable). The unit of analysis is the village-season -- from 2002 to 2013 -- focusing only on the monsoon (kharif) season. The data used to construct the yield measure is calculated using five months of data, so the wind variable is defined for the same five months and is the sum of days in which the wind is pointed towards the village centroid from a coal plant.

The first column presents the most simple results, with only the wind exposure variable and the fixed effects. The second column adds a rainfall and average temperature variable. While I leave them out of the table for simplicity, the coefficients are in the expected direction: rainfall is positive and average temperature is negative. The third column adds higher-order weather variables for both rainfall and temperature, as well as the interaction between them. This attenuates the relationship between wind and productivity somewhat, but the coefficient remains negative and statistically significant.

The final column includes the most flexible form for the weather variables. The z-score for rainfall is turned into bins -- with cutoffs at $z=-1$ and $z=1$ -- based on rainfall in each month of the season. In other words, over the five months, I create 15 different indicator variables for rainfall based on the z-score in each month. One of these indicators drops out for each month of the year, leaving 10. I also include interactions between all of these and temperature, as well as between the bins and temperature squared. The coefficient on wind remains negative and statistically significant, and is actually slightly larger in magnitude than the results in column three, which is a much less flexible specification for weather. This leads me to conclude that the results are not being driven by weather patterns.


```{r yieldtable, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(yield1reducedform) <- c("(1)", "(2)", "(3)", "(4)")

rownames(yield1reducedform) <- c("wind days", " ", 
                                  "weather", "weather (expanded)", "weather (expanded, bins)",
                                  "fixed effects:", "village", "year",
                                  "observations")
kable(
      yield1reducedform, caption = "Wind direction and agricultural productivity",
      align = "cccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in all regressions is estimated agricultural yield, defined as tons per hectare. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "4cm") %>%
  column_spec(c(2:4),width = "2.5cm") %>%
  row_spec(6, bold = TRUE) %>%
  row_spec(8, hline_after = TRUE) %>%
  #add_header_above(c(" ", "all" = 3, "monsoon" = 1, "winter" = 1)) %>%
  kable_classic_2()

```

To put the size of the coefficient in context, it is worth digging a little deeper into the exposure variable. The mean within-village absolute deviation in wind exposure is approximately 2.42 days, meaning that the average change in agricultural productivity from year-to-year due to nothing but changes in wind patterns carrying particulate matter is around 1.5 percent relative to the mean. This implies that swings in agricultural productivity -- due to wind direction -- of several percent are probably quite common, since the absolute deviation includes deviations above and below the mean.

```{r yieldtablepm, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(yield2naive) <- c("(1)", "(2)", "(3)", "(4)")
rownames(yield2naive) <- c("Particulate matter (log PM 2.5)", "", 
                           "Weather", "Weather (expanded)", "weather (expanded, bins)",
                           "Fixed effects:", "Village", "Year",
                           "Observations")
kable(
      yield2naive, caption = "Particulate matter (PM 2.5) and agricultural productivity",
      align = "cccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in all regressions is estimated agricultural yield, defined as tons per hectare. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "5cm") %>%
  column_spec(c(2:4),width = "2cm") %>%
  row_spec(6, bold = TRUE) %>%
  row_spec(8, hline_after = TRUE) %>%
  kable_classic_2()

```


Of course, it is not wind, per se, that we are interested in. Instead, we are actually interested in better understanding the effects of exposure to pollution on agricultural productivity. Table \@ref(tab:yieldtablepm) presents the same regressions as Table \@ref(tab:yieldtable), with a key difference: instead of wind exposure, it uses log average concentration of $\mathrm{PM 2.5}$ -- from @hammer2020global -- during the season as the key explanatory variable. There is again a consistent, negative relationship between particulate matter and agricultural productivity. Since both variables are logged, the coefficients are similar to elasticities, indicating that a one-percent increase in pollution leads to an approximately 0.04 percent decrease in agricultural productivity in three of the columns. 

Recall, however, the results from above: coal plants were placed in places with higher average agricultural productivity. This means that the simple regressions in Table \@ref(tab:yieldtablepm) might actually be biased upwards: although pollution might negatively affect productivity, pollution is higher in more productive areas due to the endogenous placement of pollution sources in the study areas. One possible way to recover the actual effect of pollution on agricultural productivity is with an instrument. If, conditional on the fixed effects and weather variables, wind direction is exogenous and only affects agricultural productivity through pollution, then it is a valid instrument for pollution.

I present these IV results in Table \@ref(tab:yieldtabletwo), with the first-stage F-statistic at the bottom. The first-stage results -- the full results are in Table \@ref(tab:yield3ivmainfirststage) of the appendix -- make clear how strong of an instrument wind is; all three F-statistics are above 1,000, meeting even the higher bar for the first-stage F-test argued for by @lee2022valid. 

The second-stage results first indicate that $\mathrm{PM 2.5}$ is a very strong predictor of agricultural productivity. Using the results in column three, a one percent increase in particulate matter leads to a 0.62 percent decrease in agricultural productivity. To put this in further perspective, the mean particulate matter concentration is just short of 40 (39.68) in the monsoon sample, while the within-village absolute deviation in particulate matter is 3.98, meaning year-to-year swings of several percent in agricultural productivity due to pollution exposure alone are common.

Column four presents one last specification; it includes a much more flexible specification for weather. This is the same binned specificaiton as I describe above. The coefficient in column four shows almost not change from those in column three, again relieving some concerns that weather may not be correctly specified, leading to a spurious correlation between particulate matter and agricultural productivity. 

```{r yieldtabletwo, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
yield3ivmain <- yield3ivmain[,-1]
colnames(yield3ivmain) <- c("(1)", "(2)", "(3)", "(4)")
rownames(yield3ivmain) <- c("Particulate matter", "(log PM 2.5)",
                            "Weather", "Weather (expanded)", "Weather (expanded, bins)",
                            "Fixed effects:", "Village", "Year",
                            "F (first stage)", 
                            "Observations")
kable(
      yield3ivmain, caption = "Pollution and agricultural productivity, IV estimates",
      align = "cccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in all regressions is estimated agricultural yield, defined as tons per hectare. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "4cm") %>%
  column_spec(c(2:5),width = "2cm") %>%
  row_spec(6, bold = TRUE) %>%
  row_spec(8, hline_after = TRUE) %>%
  #add_header_above(c(" ", "all" = 3, "monsoon" = 1, "winter" = 1)) %>%
  kable_classic_2()

```

The comparison of the results to those in the previous table also confirm the concerns around endogenous placement of pollution sources. The coefficients in Table \@ref(tab:yieldtabletwo) are substantially more negative than those in Table \@ref(tab:yieldtablepm). In other words, the simple regression of agricultural productivity on pollution results in coefficients on pollution that are upwards biased, since higher levels of pollution occur in more productive areas, on average. The IV strategy corrects this bias and leads to a robust, negative relationship between pollution and agricultural productivity. 


## Robustness checks

In this section, I report the results of two separate robustness checks for the main results presented above. In the previous results, standard errors are clustered at the level of the village, which is also the level at which treatment (exposure to pollution) is assigned as well as the level at which agricultural productivity is extracted. Past work has shown that standard errors might be underestimated in such contexts [@bertrand2004much]. This is a particular concern in the present case, since agricultural productivity is extracted at the village level but estimated using less coarse data that has high spatial correlation [@gangopadhyay2022new]. 

To help remedy concerns, I perform randomization inference (e.g. @barrios2012clustering) by randomly assigning observed treatment across villages and repeating this process 1,000 times. I do this in two separate ways. First, I take all villages in a given year and randomly assign, with replacement, treatment intensity within the year. Second, I do this separately by selecting from within district-years only, to help take into account district-year correlation in outcomes and as a way to mitigate possible concerns that traditional clustered standard errors may actually be much too conservative [@abadie2023should]. Since this is an instrumental variables procedure, I randomly select the wind and pollution variable _together_.

I present these results in Figure \@ref(fig:randomplot) of the appendix. The purple density is the resulting distribution of estimated treatment effects when selecting from all villages within the same year. The density of treatment effects is relatively tight around 0, with the left tail only reaching slightly beyond -0.05, compared to the most conservative actual estimated treatment effect of -0.63.

The within-district correlation in outcomes and treatment is apparent when instead randomly selecting from only villages within the same district in the same year. The distribution is still approximately normal but has a mode of almost -0.4. Nonetheless, the actual treatment effect is larger in magnitude than almost all of the bootstrapped replications. The results are apparently robust to alternative specifications of uncertainty.

The second robustness check includes leads of pollution and wind direction. I instrument for future pollution using future wind direction, which mirrors the strategy employed in the main results. I present these results in Table \@ref(tab:yieldtableleads). Neither a one-year nor a two-year lead predicts current agricultural productivity, which supports the identification assumptions.

```{r yieldtableleads, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(yield3ivmain_lead) <- c("(1)", "(2)")
rownames(yield3ivmain_lead) <- c("particulate matter (one-year lead)", "",
                                  "particulate matter (two-year lead)", "",
                                  "weather (expanded)",
                                  "fixed effects:", "village", "year",
                                  "F", 
                                  "observations")
kable(
      yield3ivmain_lead, caption = "Agricultural productivity and pollution leads",
      align = "cc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in all regressions estimated agricultural yield (tons per hectare). * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "5.5cm") %>%
  column_spec(c(2:3),width = "1.5cm") %>%
  row_spec(c(8), hline_after = TRUE) %>%
  row_spec(c(6), bold = TRUE) %>%
  kable_classic_2()

```



## Heterogeneity

Having established that exposure to pollution has a negative effect on agricultural productivity, I now move to the heterogeneity in these effects to better understand whether certain areas are driving the effects. Table \@ref(tab:yieldtablehet) presents three different analyses: heterogeneity by median exposure, heterogeneity by initial yield, and possible multiplicative effects of shocks. All regressions use the IV strategy detailed above and I include the F statistic from the first stage regressions (of which there are two in the last column) at the bottom of the table.

The first two columns split the sample based on median exposure. In other words, for each village, I calculate the median exposure (based on wind) and then use this single value for each village to split the sample into villages above and below the median. The coefficient in the first column is only slightly larger than the coefficient in the second column, indicating that pollution does not have large differential effects based on exposure. One possible explanation is that exposure is not cumulative, but continues to be harmful regardless of the baseline level. 

Columns three and four split the sample based on median yield at the very beginning of the sample (the first year available, 2002). Column three presents results for villages above the median while column four presents results for villages below the median. The largest effects are apparently concentrated in the upper half of the distribution, meaning the most productive areas are also most susceptible to the effects of pollution. This could have important implications for the overall effects of the placement of any point sources of pollution.

Given ongoing changes in the climate, a key question is how welfare will change as shocks become more and more common. The last column looks at possible multiplicative effects of shocks by interacting pollution with rainfall and seeing whether the effects compound one another. Since there are now two endogenous regressors, I instrument for both using wind exposure and an interaction between wind exposure and rainfall. 

```{r yieldtablehet, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(yield5heterogeneity) <- c(">p(50)", "<=p(50)", ">p(50)", "<=p(50)", "")
rownames(yield5heterogeneity)[c(1, 3)] <- c("PM 2.5", "PM times rain")
rownames(yield5heterogeneity) <- c("Particulate matter", "(log PM 2.5)", "PM times Rain", "", "Weather",
                                   "Fixed effects:", "Village", "Year", 
                                   "F (1st stage, PM)", "F (1st stage, PM times rain)", 
                                   "Observations")
kable(
      yield5heterogeneity, caption = "Heterogeneity in the effects of pollution on productivity",
      align = "ccccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in all regressions is estimated agricultural yield, defined as tons per hectare. The first two columns split the sample based on the median exposure (by village). The second two columns split the sample based on initial -- the first year available -- agricultural productivity. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "4.5cm") %>%
  column_spec(c(2:6),width = "1.8cm") %>%
  row_spec(c(8), hline_after = TRUE) %>%
  row_spec(c(6), bold = TRUE) %>%
  add_header_above(c(" " = 1, "Wind" = 2, "Yield" = 2, " " = 1)) %>%
  kable_classic_2()

```


The coefficient on the level term for pollution is negative. Since rainfall is defined as a z score, this represents the effect of pollution only when rainfall is at its mean value for a given season. The interaction term, on the other hand, is positive. Since higher values of rainfall are generally good, this positive coefficient represents a compounding effect of pollution and rainfall; when rainfall is low (bad), the effects of particulate matter on agricultural productivity is larger (more negative). Another way to think about this, however, is that higher values of rainfall dampen the effects of pollution shocks. This could have very profound effects on welfare, since this essentially increases the variance of agricultural productivity across years (which is already increasing due to climate change), at least as it relates to pollution exposure. Given the importance of variability to welfare [@dercon2002income; @merfeld2023poverty], this could have important implications for the effects of pollution on welfare.


```{r crops, echo = FALSE, message = FALSE, warning = FALSE, dev='png', fig.height = 5, fig.cap = "Most common crop by village", fig.footer = list("Note: The figure shows the most common crop grown in each village, by area harvested.")}

village_shp <- village_shp %>% left_join(crops_all, by = c("shrid"))

# plot
ggplot() +
  geom_sf(data = village_shp, aes(fill = most_common), color = NA) +
  scale_fill_brewer("Most common crop\nby area harvested", palette = "Set3") +
  geom_sf(data = india_shape2, fill = NA, lwd = 0.01) +
  theme_minimal()

```



## Crops and labor intensity

A key question about the results is the mechanism. While previous results indicate that pollution may actually increase land productivity [@sanders2022adaptation], the results in that paper come from the United States, where agricultural practices vary greatly from those in India. On the other hand, we also know that pollution can affect labor productivity in other contexts [@chang2019effect; @ebenstein2016long; @graff2012impact; @wen2022lower]. Unfortunately, there is no available labor data that would allow me to directly test the effects of pollution on agricultural labor productivity. While the National Sample Survey is nationally representative, it does not allow one to back out productivity, only total labor allocation in the preceding week. Additional data options -- like the ARIS-REDS or IHDS -- are not collected frequently enough to enable the kind of analysis employed here.

Instead, I look at heterogeneity by the modal crop grown in each area. I use data from @monfreda2008farming, who estimate area harvested by crop at a resolution of approximately 10km. These estimates come from around the year 2000, at the beginning of my sample period. I identify areas where rice is the most commonly grown crop. Rice (paddy) is commonly regarded as a labor-intensive crop in India [@vollrath2011agricultural; @michler2020agriculture], meaning that it may be more susceptible to pollution if some of the effects of pollution are through direct effects on labor productivity.

Figure \@ref(fig:crops) shows the distribution of the most common crop across the villages in my sample. Though there are large areas where rice is the most commonly grown crop, there is also quite a bit of overlap, especially in the middle parts of the country. However, given the geographic concentration of rice production, I will implement a robustness check with state-by-year fixed effects below.


```{r yieldrice, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
yieldrice <- yieldrice[,-1]
colnames(yieldrice) <- c("(1)", "(2)")
rownames(yieldrice) <- c("Particulate matter (log PM 2.5)", "",
                                "PM 2.5 times rice", " ",
                                "Weather (expanded)", "Weather (expanded, bins)",
                                "Fixed effects:", "Village", "Year",
                                "F (PM 2.5)", "F (PM 2.5 times rice)", 
                                "Observations")
kable(
      yieldrice, caption = "Agricultural productivity by most common crop",
      align = "cc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in all regressions estimated agricultural yield (tons per hectare). The rice dummy equals one in villages where rice is the most commonly harvested crop. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "5.5cm") %>%
  column_spec(c(2:3),width = "2cm") %>%
  row_spec(c(9), hline_after = TRUE) %>%
  row_spec(c(7), bold = TRUE) %>%
  kable_classic_2()

```

Table \@ref(tab:yieldrice) presents the main results in this section. I continue to employ an IV strategy, interacting pollution with an indicator for rice and instrumenting this with an interaction between wind and rice. The first row shows the effects of overall pollution on agricultural productivity in villages where rice is not the most commonly grown crop. Column two, which has the most flexible weather specification, indicates that an increase of particulate matter by one percent decreases productivity in these areas by around 0.4 percent. The second row is an interaction term between rice and PM 2.5, meaning the linear combination of the two coefficients gives the overall effect of pollution on productivity in rice-predominant villages. The coefficient of -0.2 shows that pollution decreases productivity by around 50 percent more in rice-growing villages than in non-rice growing villages. Since rice is more labor intensive, this is evidence that the effects of pollution work at least partly through the effects of pollution on labor productivity. This does not, however, rule out any direct effects on land productivity.

Given the geographic concentration of crops, Table \@ref(tab:yieldricestatefe) in the appendix presents the same results but with state-by-year fixed effects, instead of just year fixed effects. This will compare the effects of pollution within states in the same year, hopefully decreasing concerns that something other than labor intensity is the main driver of the heterogeneity documented in Table \@ref(tab:yieldrice). The results are consistent with those presented here, and show that pollution decreases productivity more in rice-growing villages than in other villages.





## Coal plants or overall pollution?

Finally, while I identify high-pollution areas using the location of coal plants, an important question is how much of the overall effect is driven by coal plants and how much is driven by other polluting industries located in areas near coal plants. I try to answer this question in Table \@ref(tab:yield7ivdiffindiff), where I implement an instrumental variables differences-in-differences, essentially instrumenting for pollution prior to the opening of a coal plant with wind and instrumenting for the interaction term (pollution times plant opening) with wind times plant opening.

Columns one and two of Table \@ref(tab:yield7ivdiffindiff) present specifications with slightly different weather controls. Column two presents the most extensive set of controls -- the flexible specification with binned weather variables -- and I focus on that column here. First, there are now two first stages but the F-tests indicate that the instruments are strong for both, including the interaction term (F = 205 in the second column). Second, the first row shows the effect of pollution on agricultural productivity prior to the opening of a coal plant; the coefficient is negative, indicating negative effects of non-coal pollution. Third, the interaction term is strongly negative and approximately the same in magnitude as the level term, indicating a very clear effect specific to coal plants, in addition to the overall negative effect of pollution.

```{r yield7ivdiffindiff, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(yield7ivdiffindiff) <- c("(1)", "(2)")
rownames(yield7ivdiffindiff) <- c("Particulate matter (log PM 2.5)", "", 
                                  "PM 2.5 times Coal", "",
                                  "Weather (expanded)", "Weather (expanded, bins)",
                                  "Fixed effects:", "Year", "Village",
                                  "F (PM)", "F (PM times Coal)", "Observations")
kable(
      yield7ivdiffindiff, caption = "Agricultural productivity and pollution source",
      align = "cc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in all regressions is estimated agricultural yield, defined as tons per hectare. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "5.5cm") %>%
  column_spec(c(2:3),width = "2cm") %>%
  row_spec(c(7), bold = TRUE) %>%
  row_spec(9, hline_after = TRUE) %>%
  kable_classic_2()

```

Importantly, since these results come from an IV, both coefficients denote the change in agricultural yield due to an increase in pollution by the same units. In other words, this is not identifying differences in overall pollution, per se, but rather differences in the effects of an increase of pollution by the same percentage. These different effects could be due to, for example, differences in emission patterns for different kinds of plants and factories; coal plants, for example, are responsible for much more mercury than other kinds of polluting industries.^[https://www.epa.gov/sites/default/files/2016-12/documents/nei2014v1_tsd.pdf]




# Conclusion

\label{conclusion}

In this paper, I show some of the negative effects associated with pollution, in general, and coal pollution, in particular. Using exogenous variation in pollution driven by changes in wind direction, results here show that pollution has a large, negative effect on agricultural productivity in India. These negative effects are at least partly due to changes in labor productivity; areas growing more labor-intensive crops see larger decreases in agricultural productivity due to pollution. Nonetheless, I am unable to rule out direct effects on land productivity with the data available.

Using instrumental variables in a differences-in-differences set up, I also show that the effects of pollution from coal, in particular, are particularly harmful to agricultural productivity. Changes of an equivalent increase in pollution lead to three times larger negative effects on agricultural productivity following the opening of a coal plant, compared to just before.

These results document relatively large, local externalities in the agricultural sector in a developing country. Since the sector is a refuge for some of the poorest citizens in the world, the results raise important questions about the current speed of the energy transition as it relates to sustainable development and poverty reduction, more generally. While we often frame the debate around greenhouse gasses in terms of climate change, there are important local reasons to reduce pollution emissions, as well. The technology for greener energy exists; at this point, it is simply a question of policies [@markard2018next; @blazquez2020some].

These results, of course, do not address possible positive effects of the building of additional power plants, which can lead to increased electricity access, or shifting more of the population into non-agricultural sectors, which can raise standards of living. As such, the main conclusion is that the location of pollution emissions -- especially from coal plants -- may be particularly important for multiple aspects of economic activity, not just health and mortality.


```{=tex}
\FloatBarrier
\newpage
\singlespacing
```
# References {.unnumbered}

::: {#refs}
:::

```{=tex}
\FloatBarrier
\newpage
```
# Appendix A {.unnumbered}

```{=tex}
\beginappendix
\FloatBarrier
```
```{r data, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

data <- matrix(NA, nrow = 7, ncol = 3)
rownames(data) <- c("shapefile", "coal plants", "wind", "pollution", "agriculture", "weather", "crops")
colnames(data) <- c("source", "geographic coverage", "temporal coverage")
data[1,1] <- "Asher et al. (2021)"
data[2,1] <- "Global Energy Monitor"
data[3,1] <- "NCAR"
data[4,1] <- "Hammer et al. (2020)"
data[5,1] <- "Gangopadhya et al. (2022)"
data[6,1] <- "TerraClimate"
data[7,1] <- "Monfreda et al. (2008)"
data[1,2] <- "India"
data[2,2] <- "global"
data[3,2] <- "global"
data[4,2] <- "global"
data[5,2] <- "India"
data[6,2] <- "global"
data[7,2] <- "global"
data[1,3] <- " "
data[2,3] <- "yearly"
data[3,3] <- "daily"
data[4,3] <- "monthly"
data[5,3] <- "two seasons/year"
data[6,3] <- "monthly"
data[7,3] <- "2000 (year)"

# Table
kable(
      data, caption = "Data sources",
      align = "ccccc", booktabs = TRUE, linesep = "", escape = TRUE
      ) %>%
  footnote(
           general = "Global Energy Monitor: globalenergymonitor.org/projects/global-coal-plant-tracker. NCAR: climatedataguide.ucar.edu/. TerraClimate: www.climatologylab.org/terraclimate.html",
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "2cm") %>%
  column_spec(2,width = "5cm") %>%
  column_spec(c(3:4),width = "3cm") %>%
  kable_styling(latex_options = "HOLD_position") %>%
  kable_classic_2()

```



```{=tex}
\FloatBarrier
\newpage
```
```{r plants, echo = FALSE, message = FALSE, warning = FALSE, dev='png', fig.cap = "Coal plants in India from 1990 to 2010", fig.footer = list("Note: The left figure shows the location of coal plants of at least 30MW in 1990. The right figure shows the location of such coal plants in 2010.")}

plant1 <- ggplot() +
                theme_map() +
                geom_sf(data = india_shape2, fill = NA, lwd = 0.01) +
                geom_sf(data = plants1990, size = 0.75, color = "black") +
                labs(x = "lon",
                     y = "lat",
                     subtitle = "A. 1990")

plant2 <- ggplot() +
                theme_map() +
                geom_sf(data = india_shape2, fill = NA, lwd = 0.01) +
                geom_sf(data = plants2010, size = 0.75, color = "black") +
                labs(x = "lon",
                     y = "lat",
                     subtitle = "B. 2010")


ggarrange(plant1, plant2)

```



```{=tex}
\FloatBarrier
\newpage
```


```{r windexample, echo = FALSE, message = FALSE, warning = FALSE, dev='png', fig.height = 8, fig.cap = "Wind direction and aggregation examples (2010-01-01)", fig.footer = list("Note: The top figure shows the average wind direction on January 1st, 2010, with zero degrees indicating north. The points are the location of coal plants on that date. The bottom figure shows the distribution of pollution exposure in a specific district -- Guna district in Madhya Pradesh -- on the same date.")}


windexample2 <- rasterFromXYZ(windexample)
windexample2 <- mask(windexample2, india_shape)
windexample2 <- rasterToPoints(windexample2)
windexample2 <- as.data.frame(windexample2)
p1 <- ggplot() + 
        theme_map() +
        geom_sf(data = india_shape, fill = NA) +
        geom_tile(data = windexample2, aes(x = x, y = y, fill = wind_example), alpha = 0.3) +
        scale_fill_viridis_c("wind direction\n(degrees)", option = "viridis") +
        geom_sf(data = plants2010, size = 0.5) +
        labs(x = "lon",
             y = "lat",
             subtitle = "A. Wind direction") +
        theme(legend.position = c(0.6, 0.05),
              legend.direction = "vertical",
              legend.key.height = unit(0.4, 'cm'),
              legend.text = element_text(size = 8),
              legend.background=element_blank() )


p2 <- ggplot() + 
        theme_map() +
        geom_sf(data = districts, fill = NA) +
        geom_sf(data = villages %>% filter(is.na(days_sum)==F), aes(fill = days_sum), lwd = NA) +
        scale_fill_viridis_c("exposure (days)", option = "viridis") +
        labs(x = "lon",
             y = "lat",
             subtitle = "B. Aggregation to district") +
        theme(legend.position = c(0.45, 0.05),
              legend.direction = "horizontal",
              legend.key.width = unit(0.8, 'cm'),
              legend.text = element_text(size = 8),
              legend.background=element_blank() ) +
        guides(fill = guide_colourbar(title.position="top", title.hjust = 0.5))

ggarrange(p1, p2,
          nrow = 2)

```



```{=tex}
\FloatBarrier
\newpage
```

```{r yield3ivmainfirststage, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
yield3ivmainfirststage <- yield3ivmainfirststage[,-c(1)]
colnames(yield3ivmainfirststage) <- c("(1)", "(2)", "(3)", "(4)")
kable(
      yield3ivmainfirststage, caption = "Wind direction and particulate matter",
      align = "cccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "4cm") %>%
  column_spec(c(2:5),width = "2cm") %>%
  row_spec(6, bold = TRUE) %>%
  row_spec(8, hline_after = TRUE) %>%
  kable_classic_2()

```


```{=tex}
\FloatBarrier
\newpage
```



```{r randomplot, echo = FALSE, message = FALSE, warning = FALSE, dev='png', fig.height = 4, fig.cap = "Randomization inference", fig.footer = list("Note: The figure presents the distribution of coefficients by randomly assigning wind direction across villages within the same year. The \"all\" distribution is created by randomly assigning a single wind value to each village, sampled with replacement across all villages in a given year. The \"within district\" randomly samples with replacement only from within the same district in the same year.")}


pal <- viridis(4)
colors <- c(paste0(pal[1]), paste0(pal[2]))
labels <- c("All", "Within district")

# plot
gg1 <- ggplot() + 
        geom_density(aes(x = coef_vec, fill = "All"), alpha = 0.5) +
        geom_density(aes(x = coefs_distfe, fill = "Within district"), alpha = 0.5) +
        scale_fill_manual(
          name = "Randomization:",
          values = colors,
          labels = labels
        ) +
        theme_minimal() +
        xlab("Distribution of coefficients") +
        ylab("Density")

colors <- c(paste0(pal[3]))
labels <- c("actual")

gg1 <- gg1 + 
        geom_vline(aes(xintercept = true_value, color = "actual")) +
        scale_color_manual(
          name = "",
          values = colors,
          labels = labels
        ) +
        theme(legend.position = c(0.4, 0.6))

gg1

```


```{=tex}
\FloatBarrier
\newpage
```



```{=tex}
\FloatBarrier
\newpage
```
```{r yield8cumulative, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(yield8cumulative) <- c("(1)", "(2)", "(3)", "(4)", "(5)")
kable(
      yield8cumulative, caption = "Cumulative exposure to pollution during the season",
      align = "ccccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "2.25cm") %>%
  column_spec(c(2:6),width = "2cm") %>%
  row_spec(c(12), bold = TRUE) %>%
  row_spec(14, hline_after = TRUE) %>%
  kable_classic_2()

```






```{=tex}
\FloatBarrier
\newpage
```
```{r yieldricestatefe, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
yieldricestatefe <- yieldricestatefe[,-1]
colnames(yieldricestatefe) <- c("(1)", "(2)")
rownames(yieldricestatefe) <- c("Particulate matter", "(log PM 2.5)",
                                "PM 2.5 times rice", " ",
                                "Weather (expanded)", "Weather (expanded, bins)",
                                "Fixed effects:", "Village", "Year",
                                "F (PM 2.5)", "F (PM 2.5 times rice)", 
                                "Observations")
kable(
      yieldricestatefe, caption = "Agricultural productivity by most common crop",
      align = "cc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in all regressions estimated agricultural yield (tons per hectare). The rice dummy equals one in villages where rice is the most commonly harvested crop. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "3.5cm") %>%
  column_spec(c(2:3),width = "2cm") %>%
  row_spec(c(9), hline_after = TRUE) %>%
  row_spec(c(7), bold = TRUE) %>%
  kable_classic_2()

```



