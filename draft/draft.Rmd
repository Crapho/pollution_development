---
title: "Air pollution and agricultural productivity in a developing country^[I thank Ariel Ortiz-Bobea, Marc Bellemare, and David Sungho Park for comments and suggestions that greatly improved the quality of the paper. The usual disclaimer applies. All scripts used in this paper are publicly available on my GitHub page: github.com/JoshMerfeld/pollution_development]"
author:
  - Joshua D. Merfeld^[KDI School of Public Policy and Management and IZA; merfeld@kdis.ac.kr]
date: "`r Sys.Date()`"
abstract: |
  | \noindent I document externalities in the agricultural sector of India due to air pollution. Using variation in pollution induced by changes in wind, I show that higher levels of particulate matter lead to decreased agricultural productivity, with changes in productivity of 10 percent being common. Combining wind direction with the rollout of coal plants, results indicate pollution from coal plants has a larger effect on agricultural productivity than other types of pollution. Given that the agricultural sector is a refuge for the poor in many developing countries, these results suggest that the effects of pollution may hit the poorest particularly hard.
  |
  | \textbf{\textit{Keywords}}: pollution, productivity, agriculture, labor, India
  | \textbf{\textit{JEL Codes}}: H40, I15, J22, O13, Q52, Q53

# Output type and options (no TOC and yes fig captions)
output:
  bookdown::pdf_document2: 
    toc: false
    fig_caption: yes
    # This also keeps the .tex file that is used to make the output (we will eventually need this for publication)
    keep_tex: yes

# Set bibliography
bibliography: references.bib

# This includes latex arguments
header-includes:
  - \newcommand{\beginappendix}{   
      \setcounter{table}{0}  
      \renewcommand{\thetable}{A\arabic{table}} 
      \setcounter{figure}{0} 
      \renewcommand{\thefigure}{A\arabic{figure}}
    }  # Relabel appendix tables/figures as e.g. A1
  - \usepackage[capposition=top]{floatrow}
  - \usepackage{placeins}   # THis is for /FloatBarrier
  - \usepackage{setspace}
  - \usepackage{dcolumn}
  - \usepackage{booktabs}
  - \usepackage{siunitx}
  - \usepackage{amsmath}
  - \usepackage{enumerate}
  - \usepackage[shortlabels]{enumitem}
  - \usepackage[hang,flushmargin]{footmisc}		# no indents on footnotes
  - \usepackage{makecell}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, dev = "cairo_pdf")

library(sf)
library(sp)
library(tidyverse)
library(scales)
library(RColorBrewer)
library(kableExtra)
library(ggpubr)
library(ggthemes)
library(rticles)
library(stats)
library(broom)
library(extrafont)
library(fixest)
library(modelsummary)
library(openxlsx)
library(raster)
library(viridis)
library(stars)
loadfonts()  # Must be run once in each session (markdown is a new "session" each time you render/knit)


# Sets wd to folder this script is in so we can create relative paths instead of absolute paths
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# We want to get the wd up to the main folder
# Need to go up two levels
setwd('..')
setwd('..')
# Double check
getwd()    # check


reportP <- function(pValue){
  if (pValue < 0.001){
    result <- "p < 0.001"
  } else {
    result <- sprintf("p = %.3f", pValue) # inserts a float into a string and simultaneously do rounding
  }
  return(result)
}

reportDec <- function(dec){
  
    result <- sprintf("%.3f", dec) # inserts a float into a string and simultaneously do rounding
  
  return(result)
}

reportDecOne <- function(dec){
  
    result <- sprintf("%.1f", dec) # inserts a float into a string and simultaneously do rounding
  
  return(result)
}

reportPercent <- function(dec){
  
    result <- sprintf("%.1f", 100*dec) # inserts a float into a string and simultaneously do rounding
  
  return(result)
}

commaNum <- function(large){
  
  
  result <- formatC(large, big.mark = ",")

  return(result)
}


# Shapefile of india
india_shape <- read_sf("data/spatial/shapefiles/state.shp")



# Coal plants
### Load raw data ----------------------------------------------------------------------------------------------------------------------------------------------------------
plants <- read.xlsx("data/raw/coal_plants.xlsx", sheet = "Units")
# India only
plants <- plants %>% filter(Country=="India")
# Also want only things with a non-missing year
plants <- plants %>% filter(is.na(Year)==F)

# Just keep what we want 
plants <- plants %>% dplyr::select(plant_id = ParentID, 
                                   unit_id = Tracker.ID, 
                                   capacity = `Capacity.(MW)`, 
                                   year_built = Year, 
                                   year_retired = RETIRED, 
                                   lat = Latitude, 
                                   lon = Longitude)


gps_points_plants <- plants %>% dplyr::select(lon, lat)
plants <- st_as_sf(SpatialPointsDataFrame(gps_points_plants, plants %>% dplyr::select(-c(lon, lat)), proj4string = CRS("EPSG:4326")))
plants <- plants %>% mutate(capacity = capacity/1000)

plants1990 <- plants %>% 
                  filter(year_built<=1990 & (year_retired>1990 | is.na(year_retired)==T)) %>%
                  group_by(plant_id) %>%
                  mutate(capacity = sum(capacity)) %>%
                  filter(row_number()==1) %>%
                  ungroup()
                  
plants2010 <- plants %>% 
                  filter(year_built<=2010 & (year_retired>2010 | is.na(year_retired)==T)) %>%
                  group_by(plant_id) %>%
                  mutate(capacity = sum(capacity)) %>%
                  filter(row_number()==1) %>%
                  ungroup()


# wind example
windexample <- readRDS("data/spatial/windexample.rds")


# district
districts <- read_sf(paste0("data/spatial/districts/districts.shp"))
districts <- districts %>% 
                dplyr::select(state = ST_CEN_CD, district = DT_CEN_CD, state_name = ST_NM, district_name = DISTRICT)
districts <- districts %>% filter(state=="23" & district=="07")
# Villages
villages <- read_sf(paste0("data/spatial/villages_overlap/villages_overlap.shp"))
villages <- villages %>% mutate(shrid = paste0(pc11_s_id, "-", pc11_tv_id)) %>%
                          dplyr::select(shrid, state = ST_CEN_CD, district = DT_CEN_CD, state_name = ST_NM, district_name = DISTRICT)
villages <- villages %>% filter(state=="23" & district=="07")
wind <- read_csv(paste0("data/clean/wind_ntl/days/date_2010-1-1.csv")) %>% as_tibble()
wind$days_sum <- apply(wind[,2:8], 1, FUN = "sum")
wind <- wind %>% dplyr::select(shrid, days_sum)
villages <- villages %>% left_join(wind, by = "shrid")
villages <- villages %>% st_set_crs(st_crs(districts))
# and crs for plants
plants1990 <- plants1990 %>% st_transform(st_crs(districts))
plants2010 <- plants2010 %>% st_transform(st_crs(districts))
india_shape2 <- india_shape %>% st_transform(st_crs(districts))

villages <- st_snap(villages, districts, tolerance = 1250)

# Tables
plantresultstable <- readRDS("pollution_development/draft/tables/plantresultstable.rds")
pollutiontable <- readRDS("pollution_development/draft/tables/pollutiontable.rds")
yield1reducedform <- readRDS("pollution_development/draft/tables/yield1reducedform.rds")
yield2naive <- readRDS("pollution_development/draft/tables/yield2naive.rds")
yield3ivmain <- readRDS("pollution_development/draft/tables/yield3ivmain.rds")
yield3ivmain_lead <- readRDS("pollution_development/draft/tables/yield3ivmain_lead.rds")
yield4monthly <- readRDS("pollution_development/draft/tables/yield4monthly.rds")
yield5heterogeneity <- readRDS("pollution_development/draft/tables/yield5heterogeneity.rds")
yield6leads <- readRDS("pollution_development/draft/tables/yield6leads.rds")
yield7ivdiffindiff <- readRDS("pollution_development/draft/tables/yield7ivdiffindiff.rds")
yield8cumulative <- readRDS("pollution_development/draft/tables/yield8cumulative.rds")
labor1all <- readRDS("pollution_development/draft/tables/labor1all.rds")
labor2rural <- readRDS("pollution_development/draft/tables/labor2rural.rds")
labor3month <- readRDS("pollution_development/draft/tables/labor3month.rds")
laborplot <- readRDS("pollution_development/draft/tables/laborplot.rds")
monthplot <- readRDS("pollution_development/draft/tables/monthplot.rds")
opplot <- readRDS("pollution_development/draft/tables/opplot.rds")
coef_vec <- readRDS("pollution_development/draft/tables/randomization_coef_vec.rds")
coefs_distfe <- readRDS("pollution_development/draft/tables/randomization_coefs_distfe.rds")
true_value <- readRDS("pollution_development/draft/tables/randomization_true_value.rds")
coef_current <- readRDS("pollution_development/draft/tables/coef_current.rds")
coef_lead <- readRDS("pollution_development/draft/tables/coef_lead.rds")



plants1990_capacity <- plants %>% filter(year_built<=1990 & (year_retired>1990 | is.na(year_retired)==TRUE))
plants2010_capacity <- plants %>% filter(year_built<=2010 & (year_retired>2010 | is.na(year_retired)==TRUE))

```

```{r, echo = F}
# This chunk will allow us to add footers below figures
library(ggplot2)

hook_plot_tex_footer <- function(x, options) {  
  x_out <- knitr:::hook_plot_tex(x, options) 
  if(!is.null(options$fig.footer)) {
    inter <- sprintf("\\floatfoot*{%s}\n\\end{figure}", options$fig.footer[1])
    x_out <- gsub(x=x_out, pattern="\n\\end{figure}", replacement=inter, fixed=TRUE)
  }
  x_out
}

knitr::knit_hooks$set(plot=hook_plot_tex_footer)

```

```{=tex}
\newpage
\doublespacing
```
# Introduction

While reliance on coal is declining in much of the world, it continues to be an important source of energy in many countries. In 2021, energy generation from coal reached an all-time high,[^1] driven in part by rapid population growth in developing countries, including India. From 1990 to 2010, India's population grew by more than 40 percent, leading to a large increase in demand for power.[^2] While natural gas has become a popular alternative in much of the world, the Indian government met much of the increased demand through the construction of coal power plants. During those same two decades, power generation from all coal units of at least 30 megawatts in the country more than doubled, from 42.4 gigawatts to more than 100 gigawatts.[^3] 

[^1]: www.iea.org/reports/coal-fired-electricity

[^2]: data.worldbank.org

[^3]: globalenergymonitor.org/

There are no doubt positive effects from this increase in power generation; for example, electricity may lead to economic and productivity growth [@dinkelman2011effects; @kline2014local; @rud2012electricity; @van2017long], though electrification alone may not be a sufficient condition [@lee2020does]. These improvements do not come without downsides, however, especially when it comes to power derived from coal. Pollutants from coal contribute to climate change and the phase out of coal energy is therefore a major climate goal [@iea2022]. Emissions from the production and burning of coal are also directly harmful to health and the environment, including pollutants like sulfur dioxide, nitrogen oxides, and mercury, to name but a few.[^4] While the use of coal had been declining, recent events -- including Russia's invasion of Ukraine -- have led to an increase in the demand for coal.[^5]

[^4]: www.eia.gov/energyexplained/coal/coal-and-the-environment.php

[^5]: www.npr.org/2022/08/15/1117560560/a-rising-demand-for-coal-amidst-war-in-ukraine

In addition to coal, pollution more generally is increasing in much of the world. Carbon dioxide equivalent per capita has almost double over the last 50 years in India, more than doubled in Indonesia, and almost tripled in China.^[https://edgar.jrc.ec.europa.eu] Of course, much of this increase is due to the development process itself; as countries develop, their economies transform, with more people moving out of agriculture and into manufacturing and services [@herrendorf2014growth]. Despite this development, agriculture remains a key sector in many developing countries, employing a large proportion of the poor [@dercon2009rural]. This also means agriculture is a key sector when it comes to poverty reduction [@christiaensen2011evolving]. Given the large effects of pollution on health and previously documented impacts on agriculture, this raises a important question: do rising pollution levels in developing countries threaten agricultural productivity?

In this paper, I study the effects of pollution on agricultural productivity in India. Previous work has suggested that there may be harmful direct effects of air pollution [@heck1982assessment; @marshall1997hidden] and water pollution [@reddy2006impact] on agricultural productivity, including work showing that gold mines -- which release large amounts of pollutants into the surrounding environment -- lead to lower agricultural productivity in Ghana [@aragon2016polluting]. These effects can work through the well-known effects on human health and productivity, but also directly through land productivity. Black carbon in soot, for example, can directly affect solar radiation reaching plants on the surface [@ramanathan2008global; @burney2014recent]. Relative to previous work in economics, this paper tackles pollution more broadly, before turning to a specific source of pollution: coal plants. I show that air pollution leads to lower agricultural productivity in India and that pollution from coal plants is particularly harmful to agriculture.

Identifying the causal effects of pollution is difficult. For starters, the construction of coal plants is likely to be endogenous, though the relationship between construction and economic conditions is not a priori clear. On the one hand, governments may locate new plants in fast-growing areas, while on the other hand, they may decide the exact location of plants based on the political power of local citizens [@kopas2020environmental]. In the case of the data I use here, coal plants are constructed in areas with higher population and higher literacy. In terms of agriculture, higher productivity predicts more coal plants in a given year as well as the construction of a coal plant over the next decade, indicating possible bias when estimating OLS regressions of agricultural productivity on pollution levels.

To identify the effects of air pollution on agricultural productivity, I identify areas of high pollution emission using the location of coal plants. While coal plants may add emissions, I show that they are located in areas with relatively higher levels of pollution, in general. Using these locations as point sources of pollution, I use plausibly exogenous changes in wind direction -- in a similar spirit to @deryugina2019mortality -- to measure the effects of pollution on key agricultural outcomes. I first plot the location of coal plants in India by year. Using a village-level shapefile, I identify all villages that are located within 30km of a coal plant at any time during the sample period, which comprises the 2000s to the 2010s, with differences across outcomes depending on data availability. I then calculate the direction from each coal plant to all villages within 30km. I include all areas, regardless of whether the coal plant has opened yet, to allow me to disaggregate the effects of pollution from coal plants with other kinds of pollution later in the paper. Using daily wind data and these spatial variables, I create an identifier separately for every village for whether a given village is located downwind from a coal plant on any given day. I then aggregate this exposure variable based on the desired analysis; for agricultural productivity, for example, I create an exposure variable measuring the total number of exposure days in the five-month agricultural season, focusing only on the monsoon (Kharif) season. More days being located downwind from a high-pollution location leads to substantially higher average concentrations of particulate matter 2.5 (PM 2.5).^[PM 2.5 is defined as particulate matter with a diameter of less than 2.5 micrometers.]

Using wind direction as an instrument for particulate matter, an increase of PM 2.5 by one percent leads to a large decrease in agricultural productivity, at around 0.73 percent. Given within-village changes in exposure, pollution could be responsible for swings of 7-to-14 percent in agricultural productivity across years. The IV estimates indicate that the effect of pollution is more negative than naïve OLS estimates, which is consistent with the evidence on the construction of coal plants; higher levels of pollution are correlated with higher levels of agricultural productivity, a relationship that the IV strategy adjusts downwards. Robustness checks confirm these main results. Randomization inference shows that the estimates are robust to alternative measures of uncertainty, while leads of pollution do not affect current agricultural productivity. 

Heterogeneity analysis shows that the negative effects of pollution are larger in villages that experience higher median exposure to pollution and in villages with higher initial yields. Finally, given how many poor farmers rely on rainfall and how weather shocks increase across the globe, I also look at possible multiplicative effects of shocks by interacting the pollution variables with a rainfall variable. Higher exposure along with less rainfall increases the negative effect of either shock individually, meaning these shocks are compounding. Given concerns regarding agricultural productivity and climate change, the rise of pollution in India may be particularly problematic for poor farmers.

I find that these effects are mostly transmitted by reductions in farm labor during narrow windows of the growing season, using labor allocation data from the National Sample Survey (NSS). While there do not appear to be large changes in labor allocation patterns when looking at the season as a whole, there is a clear pattern when we break down exposure to pollution by month: higher levels of pollution at the beginning of the monsoon season (June and July) lead to lower levels of farm labor allocation, but no changes in non-farm labor allocation. This matches up well with a similar exercise with agricultural yields: pollution in June is the only month in which there is a negative effect of pollution on agricultural yield. In tandem, these two results point to effects on labor as one mechanism driving the total effects, though I cannot rule out direct effects of pollution on land productivity with my data.

The final set of analyses tries to disentangle the effects of pollution from the effects of coal pollution, specifically, by using wind direction and the rollout of coal plants across the country. Combining instrumental variables with a differences-in-differences strategy, I show that agricultural productivity has an elasticity of around -0.15 with respect to non-coal pollution. The opening of a coal plant, however, triples the elasticity, to more than -0.45, indicating that coal plant emissions are particularly harmful to agricultural productivity, at least in India. This is consistent with coal emissions being quite different from other forms of pollution; for example, coal emissions contain much more mercury than other forms of pollution.

This paper contributes to several strands of literature. First, we already have evidence of effects of pollution on different forms of labor activity. For example, general levels of pollution decrease productivity of call center works in China [@chang2019effect], lead people to perform worse on cognitive functions [@ebenstein2016long; @wen2022lower], and also lead to lower levels of farm labor productivity in California, driven by changes in ozone concentration [@graff2012impact]. Also in China, @he2019severe find small but significant negative effects of pollution on manufacturing productivity, while @chen2022effect show pollution leads to labor out migration. Perhaps relevant to my labor allocation results, @hanna2015effect show that decreases in pollution lead to increases in labor allocation, while I show the same relationship in at least a subset of months of the agricultural season. Several papers are closely related to this one. @aragon2016polluting show that gold mines in Ghana have substantial negative impacts on agricultural productivity in the surrounding areas. @burney2014recent model the effects of climate change and pollutants on agricultural productivity in India. Finally, @sanders2022adaptation actually find that coal emissions can be good for agriculture in the United States, due to the presence of sulfur, which can increase agricultural productivity. This paper differs in three important ways. First, I explore effects of pollution more generally as well as from coal plants, which are much more ubiquitous than gold mines across the world. Second, I use a different identification strategy from either paper, relying on wind blowing pollution from coal plants. Finally, agriculture in India and the United States can be quite different, with the latter being much more mechanized. This means effects of pollution could differ substantially.


I also contribute to the more general literature on the effects of pollution on health. Pollution has substantial negative effects on health in both developing and developed countries [@arceo2016does] and we have known of these negative effects for many years [@brunekreef2002air; @kampa2008human; @pope2006health]. @currie2014we review the literature on the health effects of pollution during adolescence; we have robust evidence of pollution exposure leading to increases in infant mortality, including in developing countries [@heft2018robust; @heft2019air]. Since these effects are often driven by heart and lung disease and asthma [@kampa2008human], this my explain the labor allocation effects I identify in this paper.

The rest of the paper is organized as follows. I first discuss data and then methodology, in two separate sections. The methodology section discusses the empirical strategy and validates the wind direction variable using data on particulate matter. I present the main results in \autoref{results} before concluding in \autoref{conclusion}.

# Data

\label{data}

The main goal of this paper is to examine whether exposure to pollution and emissions from coal plants, in particular, affect agricultural productivity. I use several sources of data, which I describe here and list in Table \@ref(tab:data) of the appendix.

The first set of data lists the location of coal plant across the globe. This data comes from Global Energy Monitor[^6] and lists all units generating at least 30 megawatts of electricity. The data on coal plants includes the year of opening (and, if applicable, the year of retirement), the GPS (latitude/longitude) location of each plant, and the amount of power produced by the units at each plant. For this paper, I do not use the information on the capacity of the plant.

[^6]: globalenergymonitor.org/projects/global-coal-plant-tracker/

Figure \@ref(fig:plants) in the appendix displays the location of coal plants in India for two specific years: 1990 and 2010. There is a clear increase in the prevalence of coal plants across the country over the two decades. Additionally, the overall capacity from coal plants increased from `r paste0(reportDecOne(sum(plants1990_capacity$capacity)))` gigawatts to `r paste0(reportDecOne(sum(plants2010_capacity$capacity)))` gigawatts, an increase of `r paste0(reportPercent((sum(plants2010_capacity$capacity) - sum(plants1990_capacity$capacity))/sum(plants1990_capacity$capacity)))` percent in just 20 years. This increase is driven both by the roll out of new plants as well as the construction of new units at existing plants, the latter of which is not shown in Figure \@ref(fig:plants).

The second dataset includes agricultural productivity for both the monsoon and winter seasons, from 2002 to 2018. To match other data, I only use the data up to 2013. This data comes from @gangopadhyay2022new and estimates land productivity (i.e. yield, in tons per hectare) for the major crops in India, using satellite-derived data. While there is a wealth of literature on measurement error in land [@desiere2018land; @abay2022nonclassical], the authors use a static cropland mask for the productivity estimates. This means that any measurement error will be constant across time and subsumed by the village fixed effects. While the measure of output is also noisy, the use of satellite-derived data and a static cropland mask reduces concerns about measurement error being responsible for the results below, especially since common sources of measurement error are unlikely to be correlated with wind direction. The authors define the monsoon season as June to October and the winter season as November to March. I focus on only the monsoon season and keep the authors' definition when matching across data below. This data is also publicly available from Nature's data-sharing website.[^7] Since the main regressions below use village fixed effects, any differences in cropping patterns across areas should not bias estimates on changes, as long as these patterns do not change markedly in response to pollution.

[^7]: springernature.figshare.com

The agricultural productivity data is available as raster files with a resolution of 500m. To aggregate this data up to a useful administrative unit, I use village-level shapefiles provided by @almn2021 and publicly available on the SHRUG platform.[^8] I aggregate the agricultural productivity data to the village level by extracting mean productivity for each feature in the shapefile. I do this separately for the monsoon season each year, from 2002 to 2013.

[^8]: www.devdatalab.org/shrug_download/

To measure exposure to pollution from coal plants, I first locate all village centroids located within 30km from a coal plant in a given year. I choose 30km due to previous research on the effects of (air) pollution [@aragon2016polluting; @bencko1977health; @li2014health]. I then calculate the direction from coal plants to all village centroids within that 30km radius. To define exposure, I then pull daily wind direction data from the National Center for Atmospheric Research.[^9] For each day, I document whether the wind is blowing towards each village centroid[^10] and then temporally aggregate this daily data depending on the temporal definition of the corresponding outcome. For example, agricultural productivity is defined across five months (e.g. the monsoon season is from June to October) so I count the total days a given village is exposed to wind blowing from *any* coal plant within 30km during those five months.

[^9]: climatedataguide.ucar.edu/

[^10]: I define "towards" as within five degrees to help take into account that I am using village centroids, using the x and y components of wind speed to calculate angles.

The top panel in Figure \@ref(fig:windexample) in the appendix is an example wind direction raster. The raster shows wind direction for the entirety of India on January 1st, 2010, as well as the location of coal power plants on that date. The prevailing winds on the date differ across the country and, though not shown in the figure, across days. This means that the overall exposure for a given area to coal plant emissions changes across time. I also pull data on particulate matter to help validate this proxy for exposure. This data comes from @hammer2020global and I also aggregate this to the village using the same method detailed above.

To help understand some of the mechanisms driving the relationship between exposure to emissions and agricultural productivity, I also include household survey data. Unfortunately, I am not aware of any publicly available survey data that covers multiple years and has identifiers below the district level. For example, the ARIS-REDS data[^11] includes GPS identifiers for one year, but that only allows GPS matching for a total of two years: 1999 and 2007/2008. The DHS, on the other hand, only has state-level identifiers (except for the newest two waves) and is also not a labor survey. Instead, I use the National Sample Survey (NSS) from the Ministry of Statistics and Programme Implementation.

[^11]: www.ncaer.org/project/additional-rural-incomes-survey-aris-rural-economic-demographic-survey-reds

The NSS is a nationally representative survey that was conducted every couple of years until relatively recently. Many rounds of the NSS also included a module on employment that asked about labor allocation over the previous seven days. I use the 61st, 62nd, 64th, 66th, and 68th rounds of the NSS, all of which include the employment module. The publicly available data also includes the date of survey, which allows me to match pollution exposure to the exact day of the survey.

The biggest issue with using the NSS is that it includes only district-level identifiers. The main exposure variables, on the other hand, are defined at a lower level of aggregation, at the village. I choose to aggregate this village-level exposure to the district level as shown in the second panel of Figure \@ref(fig:windexample) -- the district is a randomly selected district in the data, Guna district in Madhya Pradesh. I use the area overlap of the villages with the district to define a weighted average of exposure for the district at a given time. I calculate the area of overlap for each village and the district as well as the overall area of the district and use these variables to define weights for individual villages. Any part of the district that does not overlap with one of the villages -- the white area in Figure \@ref(fig:windexample) -- does not have any exposure and, as such, receives a value of zero for exposure.




# Methods

\label{identification} 


I am primarily interested in the effects of pollution on agricultural productivity. We might consider a regression of the following form:
\begin{gather} y_{it} = \alpha_{i} + \gamma_{t} + \beta PM_{it} + \delta rain_{it} + \psi temp_{it} + \varepsilon_{it}, \end{gather}

where $y_{it}$ is outcome $y$ for unit $i$ at time $t$, $\alpha$ is a geographic fixed effects, $\gamma_t$ is time fixed effects, $PM_{it}$ is the (log) concentration of particulate matter 2.5, $rain_{it}$ is total rainfall during the season, and $temp_{it}$ is average temperature during the season.

However, even with the fixed effects, this regression likely suffers from endogeneity; places with more pollution may be very different from places with less pollution. It is difficult to sign the direction of the bias a priori, because it depends on how the coal plants are placed. For example, if coal plants are placed in places in need of power -- for example, due to rapid growth -- then the estimates might be upwards biased. On the other hand, if officials purposefully place coal plants in poorer areas for political reasons, then the estimates might be downwards biased. 

So what are the characteristics of areas near the construction of new coal plants? Table \@ref(tab:plantresultstable) presents four separate regressions, using state-level fixed effects due to the spatial variation in coal plants. The first two columns use 1991 census data -- downloaded from SHRUG -- and the second two columns use 2001 census data, all at the village level. The first column presents results from regressing a dummy for whether there is a coal plant within 30km in 1991 on several census variables. Villages with higher populations and higher literacy in 1991 are more likely to be near a coal plant at the time.

```{r plantresultstable, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(plantresultstable) <- c("1991", "2001", "2001", "2011")
rownames(plantresultstable) <- c("Population (log)", "", "Area (log)", "", "Literacy (prop)", "", "Ag. productivity", "", "Pollution", "(log PM 2.5)",
                                "Sub-sample", "Observations")
kable(
      plantresultstable, caption = "Local characteristics and the construction of coal plants",
      align = "cccc", booktabs = TRUE, linesep = "", escape = FALSE
      ) %>%
  footnote(
           "Note: State fixed effects are included in regressions. Standard errors are in parentheses and clustered at the state level. The outcome in the first column is whether the village is within 30km of a coal plant in 1991. The second column is whether a village in 1991 will have a coal plant in 2001, conditional on not having one in 1991. The last two columns are similarly defined, except using 2001 and 2011 as the years. * p<0.10 ** p<0.05 *** p<0.01",
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE,
           escape = FALSE
           ) %>%
  column_spec(1, width = "3cm") %>%
  column_spec(c(2:5),width = "2cm") %>%
  row_spec(11, hline_after = TRUE) %>%
  add_header_above(c(" ", "1991 census" = 2, "2001 census" = 2)) %>%
  kable_classic_2()

```

The second column keeps the 1991 census data but changes the outcome variable to a dummy for whether there *will be* a coal plant constructed within 30km before 2001. This column restricts the sample to only villages that do not already have a coal plant within 30km in 1991. Population and literacy both remain strong predictors of the building of a new coal plant.

The last two columns are particularly relevant to the current results. They present similar results to those in the first two columns, but use the 2001 census data and a dummy for the presence of a coal plant in 2001 and 2011 in columns three and four, respectively. Importantly, I include agricultural productivity in the monsoon season of 2002 -- the earliest year available -- as well as average pollution during the monsoon season for 1998 through 2000 as additional predictors. In 2001, agricultural productivity is a strong predictor for the presence of a coal plant. Moreover, it is also a significant predictor of the construction of a coal plant between 2001 and 2011 (column four). Given that the coefficient is positive, this indicates that coal plants are more likely to be built in areas with higher agricultural productivity. In other words, any selection in the overall location of coal plants would bias against finding negative effects of pollution on agricultural productivity. However, note that this is not the same as looking at wind direction, though comparing the OLS and IV results below leads to the same conclusion regarding selection. Pollution, on the other hand, is not significant but is positive in both columns (and is also logged, just like productivity).

Given the likely endogeneity, I instead turn to a plausibly exogenous source of variation in pollution: wind direction. While the location of a coal plant might be endogenous, the amount of pollution received by a specific village in a given year can vary randomly based on wind direction. By counting the number of days in a given year that a village is downwind from a polluted area and conditioning on village fixed effects and weather (rainfall and temperature), variation across years is plausibly exogenous.

Consider the reduced form effect of wind exposure on agricultural productivity:
\begin{gather} y_{it} = \alpha_{i} + \gamma_{t} + \beta wind_{it} + \delta rain_{it} + \psi temp_{it} + \varepsilon_{it}, \end{gather}

where variables are defined identically to above but with wind as the primary variable of interest instead of pollution. Combining these into a two-stage procedure, we can instrument for pollution using wind direction; small changes in wind direction can lead to large changes in pollution exposure for villages located near point sources of pollution, allowing me to identify the causal effects of pollution by isolating the random component driven by wind direction. This is similar in spirit to @deryugina2019mortality.

Identification relies on changes in wind direction across time for the same geographic units. In other words, conditional on the fixed effects and weather, I assume changes in wind direction are as good as random and uncorrelated with the outcome -- primarily agricultural productivity in this paper -- except through exposure to pollution.

The inclusion of rainfall and temperature is meant to reduce concerns that wind direction may not affect agricultural productivity but, instead, be correlated with it through changes in weather. For example, prevailing winds from one direction may be associated with dry weather, while winds from another direction may be more likely to carry moisture and rain. It is not a priori clear how this would bias the estimates with respect to pollution and coal plants, however. The differences in weather patterns is very context specific and can differ even for villages located near one another. Nonetheless, adding rainfall and temperature should alleviate some of these concerns.

It is worth taking the time to validate the use of wind direction as a measure of exposure to pollution. Consider the data used for the regressions presented in Table \@ref(tab:pollutiontable) of the appendix. The outcome variable is particulate matter -- specifically, $\mathrm{PM 2.5}$, which is particulate matter no larger than 2.5 micrometers in diameter -- which comes from @hammer2020global. $\mathrm{PM 2.5}$ is one of the harmful byproducts from coal plants, along with sulfur dioxide, different types of nitrogen oxides, and mercury.[^12] This data is available at the monthly level, so in Table \@ref(tab:pollutiontable), I aggregate wind exposure to the monthly level, as well.

[^12]: www.epa.gov/airmarkets/power-plants-and-neighboring-communities

Both the particulate matter data and the wind data is at the village level, which means the regressions in Table \@ref(tab:pollutiontable) are at the village level. As such, the geographic fixed effects are village fixed effects and the temporal fixed effects are month fixed effects. Since the exposure variable is at the village level and we follow villages over time, the standard errors are also clustered at the village level. In columns two and four, I switch the month fixed effects for district-month fixed effects, which considers only villages in the same district in the same month.

In addition to serving as an example, Table \@ref(tab:pollutiontable) also helps validate the use of wind direction as a proxy for exposure to pollution. The first two columns include all available years of data while the last two columns restrict estimation only to the years for which the agricultural productivity regressions are estimated. Across all four columns, the story is the same: when the wind is blowing in the direction of a village from a coal plant within 30 kilometers, estimated $\mathrm{PM 2.5}$ is substantially higher.

To put context behind pollution numbers, the World Health Organization's updated guidelines are that average annual exposure should not exceed 15 $\mathrm{\mu g/m^3}$. For the month, an increase at the midpoint of the estimated range is equal to an increase of 0.2 percent of the maximum recommended mean concentration from the WHO. This is just a single day of wind in the direction of a village. Since this includes all villages located within 30km of a coal plant, this is evidence that wind direction can have serious repercussions on the health of hundreds of millions of people in India.

## Identifying effects of pollution from coal plants

I use the location of coal plants to identify locations of high pollution, but there can be other pollution sources located near coal plants, as well. I nonetheless want to identify the effects of pollution coming specifically from coal plants. I do this by combining the two-stage procedure above with a differences-in-differences framework. Specifically, I create a new variable identifying the exact year the coal plant opens in a given area and calculate the change in the effects of pollution on agricultural productivity.

Consider the following regression of interest:
\begin{gather} 
y_{it} = \alpha_{i} + \gamma_{t} + \omega PM_{it} + \phi open_{it} + \beta PM_{it}\times open_{it} + \delta rain_{it} + \psi temp_{it} + \varepsilon_{it},
\end{gather}

where the interaction term $PM_{it}\times open_{it}$ indicates the change in the effect of pollution following the opening of the coal plant. Note that this is not the same as saying that pollution increased; instead, it is focusing on the change in the effect of a change in pollution of one unit on the outcome of interest, agricultural yield. I instrument for both $PM_{it}$ and $PM_{it}\times open_{it}$ using wind and the interaction between wind and the open indicator, or $wind_{it}\times open_{it}$.



# Results

\label{results}

I first present the reduced form results for agricultural productivity. The outcome of all the regressions in this section is the log of agricultural land productivity, which is defined as tons per hectare. The first set of results are in Table \@ref(tab:yieldtable). The unit of analysis is the village-year -- from 2002 to 2013 -- focusing only on the monsoon (kharif) season. The data used to construct the yield measure is calculated using five months of data, so the wind variable is defined for the same five months and is the sum of days in which the wind is pointed towards the village centroid from a coal plant.

The first column presents the most simple results, with only the wind exposure variable and the fixed effects. The second column adds a rainfall and average temperature variable, while the third column includes higher-order weather variables, as well. While the coefficient decreases slightly in magnitude as we move from the first to the second column and the second to the third column, the decrease is relatively small. There is a consistent, negative effect of wind exposure on agricultural productivity.

```{r yieldtable, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(yield1reducedform) <- c("(1)", "(2)", "(3)")

rownames(yield1reducedform) <- c("Wind days", " ", "Rain (z)", "", "Mean temperature (10s)", "",
                                  "Rain squared", " ", "Temperature squared", " ", "Rain times Temperature", " ",
                                  "Fixed effects:", "Village", "Year",
                                  "Observations")
kable(
      yield1reducedform, caption = "Wind direction and agricultural productivity",
      align = "ccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in all regressions is estimated agricultural yield, defined as tons per hectare. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "4cm") %>%
  column_spec(c(2:4),width = "2.5cm") %>%
  row_spec(13, bold = TRUE) %>%
  row_spec(15, hline_after = TRUE) %>%
  #add_header_above(c(" ", "all" = 3, "monsoon" = 1, "winter" = 1)) %>%
  kable_classic_2()

```

To put the size of the coefficient in context, it is worth digging a little deeper into the exposure variable. The mean within-village absolute deviation in wind exposure is approximately 2.42 days, meaning that the average change in agricultural productivity from year-to-year due to nothing but changes in wind patterns carrying particulate matter is around 1.5 percent relative to the mean. This implies that swings in agricultural productivity -- due to wind direction -- of several percent are probably quite common, since the absolute deviation includes deviations below and above the mean.

```{r yieldtablepm, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(yield2naive) <- c("(1)", "(2)", "(3)")
rownames(yield2naive) <- c("Particulate matter", "(log PM 2.5)", 
                           "Weather", "Weather (expanded)",
                           "Fixed effects:", "Village", "Year",
                           "Observations")
kable(
      yield2naive, caption = "Particulate matter (PM 2.5) and agricultural productivity",
      align = "ccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in all regressions is estimated agricultural yield, defined as tons per hectare. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "4cm") %>%
  column_spec(c(2:4),width = "2.5cm") %>%
  row_spec(5, bold = TRUE) %>%
  row_spec(7, hline_after = TRUE) %>%
  #add_header_above(c(" ", "all" = 3, "monsoon" = 1, "winter" = 1)) %>%
  kable_classic_2()

```


Of course, it is not wind, per se, that we are interested in. Instead, we are actually interested in better understanding the effects of exposure to pollution on agricultural productivity. Table \@ref(tab:yieldtablepm) presents the same regressions as Table \@ref(tab:yieldtable), with a key difference: instead of wind exposure, it uses log average concentration of $\mathrm{PM 2.5}$ -- from @hammer2020global -- during the season as the key explanatory variable. There is again a consistent, negative relationship between particulate matter and agricultural productivity. Since both variables are logged, the coefficients are similar to elasticities, indicating that a one-percent increase in pollution leads to a 0.03-to-0.04 percent decrease in agricultural productivity.

Recall, however, the results from above: coal plants were placed in places with higher average agricultural productivity. This means that the simple regressions in Table \@ref(tab:yieldtablepm) might actually be biased upwards: although pollution might negatively affect productivity, pollution is higher in more productive areas due to the endogenous placement of coal plants in the study areas. To recover the actual effect of pollution, we need an instrument. If, conditional on the fixed effects and weather variables, wind direction is exogenous and only affects agricultural productivity through pollution, then it is a valid instrument for pollution.

I present the IV results in Table \@ref(tab:yieldtabletwo), with the first-stage F-statistic at the bottom. The first-stage results make clear how strong of an instrument wind is; all three F-statistics are above 1,000, meeting even the higher bar for the first-stage F-test argued for by @lee2022valid. Also note that the coefficients are quite different from those in Table \@ref(tab:pollutiontable) because the unit of analysis in Table \@ref(tab:yieldtabletwo) is the season, while in Table \@ref(tab:pollutiontable) the unit of analysis is the month.

The second-stage results first indicate that $\mathrm{PM 2.5}$ is a very strong predictor of agricultural productivity. Using the results in column three, a one percent increase in particulate matter leads to a 0.73 percent decrease in agricultural productivity. To put this in further perspective, the mean particulate matter concentration is just short of 40 (39.68) in the monsoon sample, while the within-village absolute deviation in particulate matter is 3.98, meaning year-to-year swings of 7-to-14 percent in agricultural productivity due to pollution exposure are common.

The comparison of the results to those in the previous table also confirm the concerns around endogenous placement of coal plants. The coefficients in Table \@ref(tab:yieldtabletwo) are always more negative than those in Table \@ref(tab:yieldtablepm), and sometimes substantially so. In other words, the simple regression of agricultural productivity on pollution results in coefficients on pollution that are upwards biased, since higher levels of pollution occur in more productive areas, on average. The IV strategy corrects this bias and leads to a robust, negative relationship between pollution and agricultural productivity.

```{r yieldtabletwo, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
yield3ivmain <- yield3ivmain[,-1]
colnames(yield3ivmain) <- c("(1)", "(2)", "(3)")
rownames(yield3ivmain) <- c("Particulate matter", "(log PM 2.5)",
                            "Weather", "Weather (expanded)",
                            "Fixed effects:", "Village", "Year",
                            "F (first stage)", 
                            "Observations")
kable(
      yield3ivmain, caption = "Pollution and agricultural productivity, IV estimates",
      align = "ccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in all regressions is estimated agricultural yield, defined as tons per hectare. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "4cm") %>%
  column_spec(c(2:4),width = "2cm") %>%
  row_spec(5, bold = TRUE) %>%
  row_spec(7, hline_after = TRUE) %>%
  #add_header_above(c(" ", "all" = 3, "monsoon" = 1, "winter" = 1)) %>%
  kable_classic_2()

```


```{r randomplot, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 8, fig.cap = "Randomization inference", fig.footer = list("Note: The figure presents the distribution of coefficients by randomly assigning wind direction across villages within the same year. The \"all\" distribution is created by randomly assigning a single wind value to each village, sampled with replacement across all villages in a given year. The \"within district\" randomly samples with replacement only from within the same district in the same year.")}


pal <- viridis(4)
colors <- c(paste0(pal[1]), paste0(pal[2]))
labels <- c("All", "Within district")

# plot
gg1 <- ggplot() + 
        geom_density(aes(x = coef_vec, fill = "All"), alpha = 0.5) +
        geom_density(aes(x = coefs_distfe, fill = "Within district"), alpha = 0.5) +
        scale_fill_manual(
          name = "Randomization:",
          values = colors,
          labels = labels
        ) +
        theme_minimal() +
        xlab("Distribution of coefficients") +
        ylab("Density")

colors <- c(paste0(pal[3]))
labels <- c("actual")

gg1 <- gg1 + 
        geom_vline(aes(xintercept = true_value, color = "actual")) +
        scale_color_manual(
          name = "",
          values = colors,
          labels = labels
        ) +
        theme(legend.position = c(0.4, 0.6))

gg1

```



## Robustness checks

In this section, I report the results of two separate robustness checks for the main results presented above. In the previous results, standard errors are clustered at the level of the village, which is also the level at which treatment (exposure to pollution) is assigned as well as the level at which agricultural productivity is extracted. Past work has shown that standard errors might be underestimated in such contexts [@bertrand2004much]. This is a particular concern in the present case, since agricultural productivity is extracted at the village level but estimated using less coarse data that has high spatial correlation [@gangopadhyay2022new]. 

To help remedy concerns, I perform randomization inference (e.g. @barrios2012clustering) by randomly assigning observed treatment across villages and repeating this process 1,000 times. I do this in two separate ways. First, I take all villages in a given year and randomly assign, with replacement, treatment intensity within the year. Second, I do this separately by selecting from within district-years only, to help take into account district-year correlation in outcomes and as a way to mitigate possible concerns that traditional clustered standard errors may actually be much too conservative [@abadie2023should]. Since this is an instrumental variables procedure, I randomly select the wind and pollution variable _together_.

I present these results in Figure \@ref(fig:randomplot). The purple density is the resulting distribution of estimated treatment effects when selecting from all villages within the same year. The density of treatment effects is relatively tight around 0, with the left tail only getting slightly beyond -0.05, compared to the most conservative actual estimated treatment effect of -0.73.

The within-district correlation in outcomes and treatment is apparent when instead randomly selecting from only villages within the same district in the same year. The distribution is still approximately normal but has a mode of almost -0.4. Nonetheless, the actual treatment effect is larger in magnitude than every single one of the 1,000 bootstrapped replications. If we were to use the standard deviation of the resulting distribution as a standard error, we would get a confidence interval around the main effect of approximately `r paste0(reportDec(-0.73-1.96*sd(coefs_distfe)))` to `r paste0(reportDec(-0.73+1.96*sd(coefs_distfe)))`. The results are apparently robust to alternative specifications of uncertainty

The second robustness check includes leads of pollution and wind direction. I present these results in Table \@ref(tab:yieldtableleads). Interestingly, there is actually a positive coefficient for the lead in the second column. However, if we perform randomization inference, it appears that the confidence intervals might be slightly underestimated; the positive effect size is in the 11th percentile of the distribution in Figure \@ref(fig:randomplotleads), which for a two-tailed test would not even have a p-value of less than 0.2. Overall, there is no indication that leads predict any changes in current agricultural productivity.

```{r yieldtableleads, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(yield3ivmain_lead) <- c("(1)", "(2)")
rownames(yield3ivmain_lead) <- c("Particulate matter", "(log PM 2.5)",
                                 "Particulate matter", "(one-year lead)",
                                 "Weather",
                                 "Fixed effects:", "Village", "Year",
                                 "F (current)", "F (lead)", 
                                 "Observations")
kable(
      yield3ivmain_lead, caption = "Agricultural productivity and pollution leads",
      align = "cc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in all regressions estimated agricultural yield (tons per hectare). * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "3.5cm") %>%
  column_spec(c(2:3),width = "2cm") %>%
  row_spec(c(8), hline_after = TRUE) %>%
  row_spec(c(6), bold = TRUE) %>%
  kable_classic_2()

```



## Heterogeneity

Having established that exposure to pollution has a negative effect on agricultural productivity, I now move to heterogeneity in these effects. Table \@ref(tab:yieldtablehet) presents three different analyses: heterogeneity by median exposure, heterogeneity by initial yield, and possible multiplicative effects of shocks. All regressions use the IV strategy detailed above and I include the F statistic from the first stage regressions (of which there are two in the last column) at the bottom of the table.

The first two columns split the sample based on median exposure. In other words, for each village, I calculate the median exposure (based on wind) and then use this single value for each village to split the sample into villages above and below median exposure. The coefficient in the first column is 2.3 times larger than the coefficient in the second column, indicating much larger effects of pollution in places where it is more common. One possible explanation is that exposure is cumulative, leading to larger and larger effects. I return to the effects of cumulative shocks in column five.

Columns three and four split the sample based on median yield at the very beginning of the sample (the first year available, 2002-2003). Column three presents results for villages above the median while column four presents results for villages below the median. The largest effects are apparently concentrated in the upper half of the distribution, meaning the most productive areas are also most susceptible to the effects of pollution. This could have important implications for the overall effects of the placement of any point sources of pollution.

Given ongoing changes in the climate, a key question is how welfare will change as shocks become more and more common. The last column looks at possible multiplicative effects of shocks by interacting pollution with rainfall and seeing whether the effects compound one another. Since there are now two endogenous regressors, I instrument for both using wind exposure and an interaction between wind exposure and rainfall. 

```{r yieldtablehet, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(yield5heterogeneity) <- c(">p(50)", "<=p(50)", ">p(50)", "<=p(50)", "")
rownames(yield5heterogeneity)[c(1, 3)] <- c("PM 2.5", "PM times rain")
rownames(yield5heterogeneity) <- c("Particulate matter", "(log PM 2.5)", "PM times Rain", "", "Weather",
                                   "Fixed effects:", "Village", "Year", 
                                   "F (1st stage, PM)", "F (1st stage, PM times rain)", 
                                   "Observations")
kable(
      yield5heterogeneity, caption = "Heterogeneity in the effects of pollution on productivity",
      align = "ccccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in all regressions is estimated agricultural yield, defined as tons per hectare. The first two columns split the sample based on the median exposure (by village). The second two columns split the sample based on initial -- the first year available -- agricultural productivity. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "4.5cm") %>%
  column_spec(c(2:6),width = "1.8cm") %>%
  row_spec(c(8), hline_after = TRUE) %>%
  row_spec(c(6), bold = TRUE) %>%
  add_header_above(c(" " = 1, "Wind" = 2, "Yield" = 2, " " = 1)) %>%
  kable_classic_2()

```


The coefficient on the level term for pollution is negative. Since rainfall is defined as a z score, this represents the effect of pollution only when rainfall is at its mean value for a given season. The interaction term, on the other hand, is positive. Since higher values of rainfall are generally good, this positive coefficient represents a compounding effect of pollution and rainfall; when rainfall is low (bad), the effects of particulate matter on agricultural productivity is larger (more negative). Another way to think about this, however, is that higher values of rainfall dampen the effects of pollution shocks. This could have very profound effects on welfare, since this essentially increases the variance of agricultural productivity across years (which is already increasing due to climate change), at least as it relates to pollution exposure..



## Labor allocation

The previous set of results show a consistent negative effect of wind-driven pollution on agricultural productivity. A key question is the mechanism through which this happens; is this driven by changes in labor allocation/productivity or by changes in land productivity? While I cannot definitely prove the mechanism, I can shed some light on possibilities by looking at labor allocation decisions. Since these shocks generally happen after initial planting decisions, it seems unlikely that changes in land *allocation* could drive the results.

Table \@ref(tab:labortable) presents results for labor allocation over the last seven days using the National Sample Survey and the methodology described above. Since the labor recall is for seven days, labor allocation ranges from zero to seven, as does the wind variable.^[I also tried an instrumental variables strategy with the seven-day wind and monthly pollution, but the first stage lacked power due to the difference in temporal aggregation across the two key variables (pollution and wind).] Recall that the data is at the district level, not the village level. However, it is also more temporally disaggregated, with rolling interviews throughout the year-long survey. Figure \@ref(fig:laborplot) in the appendix shows this temporal distribution across the five waves of the survey. Since pollution is not disaggregated at a daily level, I instead stick to the reduced form results with wind.


```{r labortable, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(labor1all) <- c("All", "All", "Self", "Wage", "Farm", "Non-farm")
colnames(labor2rural) <- c("All", "All", "Self", "Wage", "Farm", "Non-farm")

mat1 <- matrix(c("", "", "", "", "", ""), nrow = 1)
colnames(mat1) <- c("All", "All", "Self", "Wage", "Farm", "Non-farm")
rownames(mat1) <- c("Panel A: all")
mat2 <- matrix(c("", "", "", "", "", ""), nrow = 1)
colnames(mat2) <- c("All", "All", "Self", "Wage", "Farm", "Non-farm")
rownames(mat2) <- c("Panel B: Rural")

labortablerural <- rbind(mat1, labor1all[c(1:2, 7:8),], mat2, labor2rural[-c(3:6),], labor2rural[c(3:6),])
rownames(labortablerural)[c(2,7)] <- "Wind"
rownames(labortablerural)[c(5,10)] <- "Observations"
rownames(labortablerural)[11] <- "Controls"
rownames(labortablerural)[12] <- "Fixed effects:"
rownames(labortablerural)[13] <- "District"
rownames(labortablerural)[14] <- "State-month"

kable(
      labortablerural, caption = "Wind direction and labor allocation by rural status",
      align = "cccccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the district level. Control variables include female, age, age squared, and (years of) education. The outcome in each regression is days worked in the previous seven days. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "3cm") %>%
  column_spec(c(2:7),width = "1.5cm") %>%
  row_spec(c(5,10), hline_after = TRUE) %>%
  row_spec(c(1,6,12), bold = TRUE) %>%
  kable_classic_2()

```


The top panel presents results for all respondents during the five-month monsoon season while the bottom panel presents results for respondents in rural areas. Interestingly, we do not see any signs of large, negative effects of wind exposure on labor allocation across any sectors, with the possible exception of wage employment in rural areas. However, the coefficient for self-employment in rural areas is of the same magnitude and *positive*, but imprecisely estimated, making it hard to come to any definitive conclusions, at least in the aggregate.



## Month-specific exposure

While overall results for labor allocation are inconclusive, perhaps we can learn more by looking at temporally disaggregated results, focusing on June through October. I can create separate variables for exposure by each month of the season, keeping the unit of analysis the individual (for labor) or the village-season (for yields).

Since the NSS data has survey dates and the both the pollution and wind data can be aggregated to the month, we can look at how exposure during different months of the agricultural season (differentially) affect labor allocation and overall agricultural productivity. I begin with labor allocation in columns one and two of Table \@ref(tab:labor3month). As before, the exposure measure is just the wind variable (over the last seven days), since I can directly match daily wind direction with the timing of the survey, but I cannot do that for pollution, which is monthly. The first column presents results for farm labor and the second column presents results for non-farm labor. 

Higher exposure leads to significantly less farm labor labor in June and July, but there are no discernible effects in other months of the year. There are likewise no discernible effects on non-farm labor, but some of the coefficients are rather imprecisely estimate. To put the effects for June and July in context and taking the coefficients at face value, an additional day of wind in the last seven days decreases farm labor in June by around `r paste0(reportPercent(0.136/1.209))` percent of the mean and in July by around `r paste0(reportPercent(0.285/1.671))` percent of the mean.


```{r labor3month, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

labor3month <- cbind(labor3month, yield4monthly[-c(15:19),2])

# Table
colnames(labor3month) <- c("Farm", "Non-farm", "Yield")
kable(
      labor3month, caption = "Heterogeneity by month",
      align = "ccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in column one is farm labor, the outcome is column two is non-farm labor, and the outcome in column three is village-level productivity. The independent variable for labor is wind, while the IV approach above is still used for yield. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "2.5cm") %>%
  column_spec(c(2:4),width = "2.5cm") %>%
  row_spec(c(14), hline_after = TRUE) %>%
  row_spec(c(12), bold = TRUE) %>%
  add_header_above(c(" " = 1, "Labor" = 2, " " = 1)) %>%
  kable_classic_2()

```


I perform a similar exercise with yield, the results of which are in the third column Table \@ref(tab:labor3month). I return to the IV strategy, however, to be consistent with the previous yield results. I include only the five months of the year that are used in the calculation of the yield estimates, or June through October. 

There is only one month where we see a clear effect of pollution on yield: June. Given that we also see negative effects of pollution on farm labor allocation in June, this is suggestive -- but not conclusive -- evidence that pollution at least partly works through labor. Note that this does not rule out pollution also having direct effects on agricultural land productivity, however.

A final caveat about these month-specific results is that they do not take into account possible interactions between different months. For example, yield might respond strongly to average pollution in June and July, which would not be captured in Table \@ref(tab:labor3month). As one additional check, Table \@ref(tab:yield8cumulative) in the appendix presents five separate instrumental variable regressions, which look at the effects of cumulative exposure to pollution separately by month. Across all five months, cumulative exposure negatively affects agricultural productivity, with the largest coefficient actually showing up for October, the last month of the season.





## Coal plants or overall pollution?


Finally, while I identify high-pollution areas using the location of coal plants, an important question is how much of the overall effect is driven by coal plants and how much is driven by other polluting industries located in areas near coal plants. I try to answer this question in Table \@ref(tab:yield7ivdiffindiff), where I implement an instrumental variables differences-in-differences, essentially instrumenting for pollution prior to the opening of a coal plant with wind and instrumenting for the interaction term (pollution times plant opening) with wind times plant opening.

```{r yield7ivdiffindiff, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(yield7ivdiffindiff) <- c("(1)", "(2)", "(3)")
rownames(yield7ivdiffindiff) <- c("Particulate matter", "(log PM 2.5)", 
                                  "PM 2.5 times Coal", "",
                                  "Weather", "Weather (expanded)",
                                  "Fixed effects:", "Year", "Village",
                                  "F (PM)", "F (PM times Coal)", "Observations")
kable(
      yield7ivdiffindiff, caption = "Agricultural productivity and pollution source",
      align = "ccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. The outcome in all regressions is estimated agricultural yield, defined as tons per hectare. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "3.5cm") %>%
  column_spec(c(2:4),width = "2cm") %>%
  row_spec(c(7), bold = TRUE) %>%
  row_spec(9, hline_after = TRUE) %>%
  kable_classic_2()

```

Columns one through three of Table \@ref(tab:yield7ivdiffindiff) present specifications with progressively increasing weather controls. Column three presents the most extensive set of controls and I focus on that column here. First, there are now two first stages but the F-tests indicate that the instruments are strong for both, including the interaction term (F = 232). Second, the first row shows the effect of pollution on agricultural productivity prior to the opening of a coal plant; the coefficient is negative, indicating negative effects of non-coal pollution. Third, the interaction term is strongly negative and more than twice as large in magnitude as the level term, indicating a very clear effect specific to coal plants, in addition to the overall negative effect of pollution. 

Importantly, since these results come from an IV, both coefficients denote the change in agricultural yield due to an increase in pollution by the same units. In other words, this is not identifying differences in overall pollution, per se, but rather differences in the effects of an increase of pollution by the same percentage. These different effects could be due to, for example, differences in emission patterns for different kinds of plants and factories; coal plants, for example, are responsible for much more mercury than other kinds of polluting industries.^[https://www.epa.gov/sites/default/files/2016-12/documents/nei2014v1_tsd.pdf]




# Conclusion

\label{conclusion}

In this paper, I show some of the negative effects associated with pollution, in general, and coal pollution, in particular. Using exogenous variation in pollution driven by changes in wind direction, results here show that pollution has a large, negative effect on agricultural productivity in India.

These negative effects are at least partly due to changes in labor allocation decisions; the largest negative effects on agricultural productivity and on labor allocation happen in the same month of the season: June. Nonetheless, I am unable to rule out direct effects on land productivity with the data available.

Using instrumental variables in a differences-in-differences set up, I also show that the effects of pollution from coal, in particular, are particularly harmful to agricultural productivity. Changes of an equivalent increase in pollution lead to three times larger negative effects on agricultural productivity following the opening of a coal plant, compared to just before.

These results document relatively large, local externalities in the agricultural sector in a developing country. Since the sector is a refuge for some of the poorest citizens in the world, the results raise important questions about the current speed of the energy transition as it relates to sustainable development and poverty reduction, more generally. While we often frame the debate around greenhouse gasses in terms of climate change, there are important local reasons to reduce pollution emissions, as well. The technology for greener energy exists; at this point, it is simply a question of policies [@markard2018next; blazquez2020some].

These results, of course, do not address possible positive effects of the building of additional power plants, which can lead to increased electricity access, or shifting more of the population into non-agricultural sectors, which can raise standards of living. As such, the main conclusion is that the location of pollution emissions -- especially from coal plants -- may be particularly important for multiple aspects of economic activity, not just health and mortality.


```{=tex}
\FloatBarrier
\newpage
\singlespacing
```
# References {.unnumbered}

::: {#refs}
:::

```{=tex}
\FloatBarrier
\newpage
```
# Appendix A {.unnumbered}

```{=tex}
\beginappendix
\FloatBarrier
```
```{r data, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

data <- matrix(NA, nrow = 7, ncol = 3)
rownames(data) <- c("shapefile", "coal plants", "wind", "pollution", "agriculture", "weather", "labor")
colnames(data) <- c("source", "geographic coverage", "temporal coverage")
data[1,1] <- "Asher et al. (2021)"
data[2,1] <- "Global Energy Monitor"
data[3,1] <- "NCAR"
data[4,1] <- "Hammer et al. (2020)"
data[5,1] <- "Gangopadhya et al. (2022)"
data[6,1] <- "TerraClimate"
data[7,1] <- "National Sample Survey (NSS)"
data[1,2] <- "India"
data[2,2] <- "global"
data[3,2] <- "global"
data[4,2] <- "global"
data[5,2] <- "India"
data[6,2] <- "global"
data[7,2] <- "India"
data[1,3] <- " "
data[2,3] <- "yearly"
data[3,3] <- "daily"
data[4,3] <- "monthly"
data[5,3] <- "two seasons/year"
data[6,3] <- "monthly"
data[7,3] <- "daily interviews"

# Table
kable(
      data, caption = "Data sources",
      align = "ccccc", booktabs = TRUE, linesep = "", escape = TRUE
      ) %>%
  footnote(
           general = "Global Energy Monitor: globalenergymonitor.org/projects/global-coal-plant-tracker. NCAR: climatedataguide.ucar.edu/. TerraClimate: www.climatologylab.org/terraclimate.html",
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "2cm") %>%
  column_spec(2,width = "5cm") %>%
  column_spec(c(3:4),width = "3cm") %>%
  kable_styling(latex_options = "HOLD_position") %>%
  kable_classic_2()

```



```{=tex}
\FloatBarrier
\newpage
```
```{r plants, echo = FALSE, message = FALSE, warning = FALSE, fig.cap = "Coal plants in India from 1990 to 2010", fig.footer = list("Note: The top figure shows the location of coal plants in 1990. The bottom figure shows the location of coal plants in 2010.")}

plant1 <- ggplot() +
                theme_map() +
                geom_sf(data = india_shape2, fill = NA, lwd = 0.01) +
                geom_sf(data = plants1990, size = 0.75, color = "black") +
                labs(x = "lon",
                     y = "lat",
                     subtitle = "A. 1990")

plant2 <- ggplot() +
                theme_map() +
                geom_sf(data = india_shape2, fill = NA, lwd = 0.01) +
                geom_sf(data = plants2010, size = 0.75, color = "black") +
                labs(x = "lon",
                     y = "lat",
                     subtitle = "B. 2010")


ggarrange(plant1, plant2)

```



```{=tex}
\FloatBarrier
\newpage
```


```{r windexample, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 8, fig.cap = "Wind direction and aggregation examples (2010-01-01)", fig.footer = list("Note: The top figure shows the average wind direction on January 1st, 2010, with zero degrees indicating north. The points are the location of coal plants on that date. The bottom figure shows the distribution of pollution exposure in a specific district -- Guna district in Madhya Pradesh -- on the same date.")}


windexample2 <- rasterFromXYZ(windexample)
windexample2 <- mask(windexample2, india_shape)
windexample2 <- rasterToPoints(windexample2)
windexample2 <- as.data.frame(windexample2)
p1 <- ggplot() + 
        theme_map() +
        geom_sf(data = india_shape, fill = NA) +
        geom_tile(data = windexample2, aes(x = x, y = y, fill = wind_example), alpha = 0.3) +
        scale_fill_viridis_c("wind direction\n(degrees)", option = "viridis") +
        geom_sf(data = plants2010, size = 0.5) +
        labs(x = "lon",
             y = "lat",
             subtitle = "A. Wind direction") +
        theme(legend.position = c(0.6, 0.05),
              legend.direction = "vertical",
              legend.key.height = unit(0.4, 'cm'),
              legend.text = element_text(size = 8),
              legend.background=element_blank() )


p2 <- ggplot() + 
        theme_map() +
        geom_sf(data = districts, fill = NA) +
        geom_sf(data = villages %>% filter(is.na(days_sum)==F), aes(fill = days_sum), lwd = NA) +
        scale_fill_viridis_c("exposure (days)", option = "viridis") +
        labs(x = "lon",
             y = "lat",
             subtitle = "B. Aggregation to district") +
        theme(legend.position = c(0.45, 0.05),
              legend.direction = "horizontal",
              legend.key.width = unit(0.8, 'cm'),
              legend.text = element_text(size = 8),
              legend.background=element_blank() ) +
        guides(fill = guide_colourbar(title.position="top", title.hjust = 0.5))

ggarrange(p1, p2,
          nrow = 2)

```



```{=tex}
\FloatBarrier
\newpage
```

```{r pollutiontable, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(pollutiontable) <- c("(1)", "(2)", "(3)", "(4)")
kable(
      pollutiontable, caption = "Wind direction and particulate matter",
      align = "cccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "4cm") %>%
  column_spec(c(2:5),width = "2cm") %>%
  row_spec(c(3), bold = TRUE) %>%
  row_spec(6, hline_after = TRUE) %>%
  add_header_above(c(" ", "1998-2015" = 2, "2002-2013" = 2)) %>%
  kable_classic_2()

```


```{=tex}
\FloatBarrier
\newpage
```



```{r randomplotleads, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 8, fig.cap = "Randomization inference for leads", fig.footer = list("Note: The figure presents the distribution of coefficients by randomly assigning a single wind value to each village, sampled with replacement across all villages in a given district in the same year. \"Current\" refers to the coefficient on current pollution, while \"lead\" refers to the coefficient on next year's pollution in the same table.")}


pal <- viridis(4)
colors <- c(paste0(pal[1]), paste0(pal[3]))
labels <- c("current", "lead")

# plot
ggplot() + 
    geom_density(aes(x = coef_current, fill = "current"), alpha = 0.5) +
    geom_density(aes(x = coef_lead, fill = "lead"), alpha = 0.5) +
    scale_fill_manual(
      name = "coefficient:",
      values = colors,
      labels = labels
    ) +
    theme_minimal() +
    xlab("distribution of coefficients")

```



```{=tex}
\FloatBarrier
\newpage
```
```{r laborplot, echo = FALSE, message = FALSE, warning = FALSE, fig.cap = "Timing of household surveys for the National Sample Survey", fig.footer = list("Note: The histogram shows the distribution of survey dates for the four waves of the National Sample Survey (NSS) for the five waves used in this paper.")}

laborplot


```



```{=tex}
\FloatBarrier
\newpage
```
```{r monthplot, echo = FALSE, message = FALSE, warning = FALSE, fig.cap = "Average farm days by season, rural only", fig.footer = list("Note: The line graph shows the mean number of farm days worked per week based on the month of the relevant agricultural season. The monsoon season is defined as June (month 1) to October (month 5) while the rainy season is defined as November (month 1) to March (month 5) of the following year. The data is from the NSS.")}

monthplot


```




```{=tex}
\FloatBarrier
\newpage
```
```{r yield8cumulative, include = TRUE, echo = FALSE, message = FALSE, warning = FALSE}

# Table
colnames(yield8cumulative) <- c("(1)", "(2)", "(3)", "(4)", "(5)")
kable(
      yield8cumulative, caption = "Cumulative exposure to pollution during the season",
      align = "ccccc", booktabs = TRUE, linesep = ""
      ) %>%
  footnote(
           "Note: Standard errors are in parentheses and are clustered at the village level. * p<0.10 ** p<0.05 *** p<0.01", 
           general_title = "",
           threeparttable = TRUE,
           footnote_as_chunk = TRUE
           ) %>%
  column_spec(1, width = "2.25cm") %>%
  column_spec(c(2:6),width = "2cm") %>%
  row_spec(c(12), bold = TRUE) %>%
  row_spec(14, hline_after = TRUE) %>%
  kable_classic_2()

```


